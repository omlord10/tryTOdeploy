<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Antivirus: antivirus.c File Reference</title>
<link rel="icon" href="../../free-icon-antivirus-3093054.png" type="image/x-icon" />
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Antivirus<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d4/de8/a00061.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">antivirus.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
</div>
<p><a href="../../d4/de8/a00061_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:d0/dc0/a00033" id="r_d0/dc0/a00033"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d46/a00002.html#d0/dc0/a00033">VirusSignature</a></td></tr>
<tr class="memdesc:d0/dc0/a00033"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a virus signature.  <a href="../../d7/d46/a00002.html#d0/dc0/a00033">More...</a><br /></td></tr>
<tr class="separator:d0/dc0/a00033"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1f9805263a7a02041237a4a990811e57" id="r_a1f9805263a7a02041237a4a990811e57"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f9805263a7a02041237a4a990811e57">MAX_SIGNATURE_LENGTH</a>&#160;&#160;&#160;8</td></tr>
<tr class="memdesc:a1f9805263a7a02041237a4a990811e57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum length (in bytes) of a virus signature.  <br /></td></tr>
<tr class="separator:a1f9805263a7a02041237a4a990811e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaedbc5a6f36b71976611496f4e3a327" id="r_acaedbc5a6f36b71976611496f4e3a327"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acaedbc5a6f36b71976611496f4e3a327">MAX_VIRUS_NAME_LENGTH</a>&#160;&#160;&#160;256</td></tr>
<tr class="memdesc:acaedbc5a6f36b71976611496f4e3a327"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum length (in characters) of a virus name string.  <br /></td></tr>
<tr class="separator:acaedbc5a6f36b71976611496f4e3a327"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58d1d45bf875bddd6dc4dadb13e11d7f" id="r_a58d1d45bf875bddd6dc4dadb13e11d7f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a58d1d45bf875bddd6dc4dadb13e11d7f">MAX_FILE_SYSTEM_ADRESS_SIZE</a>&#160;&#160;&#160;256</td></tr>
<tr class="memdesc:a58d1d45bf875bddd6dc4dadb13e11d7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum length (in characters) of a file system path or address.  <br /></td></tr>
<tr class="separator:a58d1d45bf875bddd6dc4dadb13e11d7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a55394e67b4669c9f3d522ff7d354487c" id="r_a55394e67b4669c9f3d522ff7d354487c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a55394e67b4669c9f3d522ff7d354487c">Error_Codes_RS</a> { <a class="el" href="#a55394e67b4669c9f3d522ff7d354487cadb1dd6134c0f933bc9659935942d908f">RS_SUCCESS</a> = 0
, <a class="el" href="#a55394e67b4669c9f3d522ff7d354487cad5c1ee2dcd3eced7b598f0f7eddde9ce">RS_NULL_FILE_PATH_POINTER</a> = 1
, <a class="el" href="#a55394e67b4669c9f3d522ff7d354487ca22802c47292e70b0a339ff994b7907c9">RS_NULL_VSTRUCT_POINTER</a> = 2
, <a class="el" href="#a55394e67b4669c9f3d522ff7d354487ca72f057ce83550944e650aaac64734965">RS_FILE_FOPEN_ERROR</a> = 3
, <a class="el" href="#a55394e67b4669c9f3d522ff7d354487ca4e716b355dce153ee5b2ff3fd2bfccd1">RS_SIGNATURE_FSCANF_ERROR</a> = 4
, <a class="el" href="#a55394e67b4669c9f3d522ff7d354487cae61710028a61c4d375b610bf6d821469">RS_OFFSET_FSCANF_ERROR</a> = 5
, <a class="el" href="#a55394e67b4669c9f3d522ff7d354487ca5bab52062e9e8a25d41337700a267d51">RS_VNAME_FSCANF_ERROR</a> = 6
, <a class="el" href="#a55394e67b4669c9f3d522ff7d354487ca0cda8a27dadca17b568a928144060c83">RS_FILE_FCLOSE_ERROR</a> = 7
 }</td></tr>
<tr class="memdesc:a55394e67b4669c9f3d522ff7d354487c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Here is a list of all enums with links to the files they belong to:  <a href="#a55394e67b4669c9f3d522ff7d354487c">More...</a><br /></td></tr>
<tr class="separator:a55394e67b4669c9f3d522ff7d354487c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d150856ebcbc39802d95e25f1330df1" id="r_a6d150856ebcbc39802d95e25f1330df1"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6d150856ebcbc39802d95e25f1330df1">Error_Codes_CFS</a> { <a class="el" href="#a6d150856ebcbc39802d95e25f1330df1ad622e94493a882562592bbe767353b71">CFS_SUCCESS</a> = 0
, <a class="el" href="#a6d150856ebcbc39802d95e25f1330df1a6d718b6f23a18eaefa43664ee3dc763d">CFS_NULL_FILE_PATH_POINTER</a> = 1
, <a class="el" href="#a6d150856ebcbc39802d95e25f1330df1a8b09752e65b1530123e2460d6536492d">CFS_NULL_FILE_SIZE_POINTER</a> = 2
, <a class="el" href="#a6d150856ebcbc39802d95e25f1330df1a1f73fee4befb453fa5534f53c04a6d5b">CFS_FILE_FOPEN_ERROR</a> = 3
, <a class="el" href="#a6d150856ebcbc39802d95e25f1330df1ad5c83b632548a90f3febe7168cc29e7d">CFS_END_FSEEK_ERROR</a> = 4
, <a class="el" href="#a6d150856ebcbc39802d95e25f1330df1aab1185a29decc2242b01e17afb12e435">CFS_SIZE_FTELL_ERROR</a> = 5
, <a class="el" href="#a6d150856ebcbc39802d95e25f1330df1aafb51e061b61c1f662dc5c3dddf19366">CFS_FILE_FCLOSE_ERROR</a> = 6
 }</td></tr>
<tr class="memdesc:a6d150856ebcbc39802d95e25f1330df1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error codes for the <a class="el" href="#ac151026d2ff41253cf6e6c247eab91b1" title="Calculates the size of a file.">calculate_file_size()</a> function.  <a href="#a6d150856ebcbc39802d95e25f1330df1">More...</a><br /></td></tr>
<tr class="separator:a6d150856ebcbc39802d95e25f1330df1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71294fb18b2f091cb4db120c47248cb4" id="r_a71294fb18b2f091cb4db120c47248cb4"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a71294fb18b2f091cb4db120c47248cb4">Error_Codes_SF</a> { <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4ae8c7a0c90e729ec8abeb076a020a549e">SF_SUCCESS</a> = 0
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4a83e9a4b31aea3d4bab1534d67bd8fac1">SF_NULL_FILE_PATH_POINTER</a> = 1
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4a83af1a50193d6dbcda3c5c1d9bdb554d">SF_NULL_VSTRUCT_POINTER</a> = 2
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4a5f412aaaa3f73e6ab637f802ee3c70dc">SF_FILE_FOPEN_ERROR</a> = 3
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4aaf13c1451cb5a1d26f4eb5bac5331bd6">SF_MZ_FREAD_ERROR</a> = 4
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4a3517b65ae973d0d3c3e9f2dabffe3923">SF_NOT_PE</a> = 5
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4add83add67dcd7ba7c6c8398b2259bc6c">SF_CFS_NULL_PATH_POINTER</a> = 6
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4a2a9d23d17b854dd73a2d3a78ac46fbb0">SF_CFS_NULL_FILE_SIZE_POINTER</a> = 7
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4a27175d186bd0cc8ef253f55c3c5a6e22">SF_CFS_FILE_FOPEN_ERROR</a> = 8
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4a9b337b7034141e114453e51d431de3cd">SF_CFS_END_FSEEK_ERROR</a> = 9
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4a8be7baf87fa305815af016e51a32e444">SF_CFS_SIZE_FTELL_ERROR</a> = 10
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4af3946e9f0e9ce7b8afc78d5e15b21bc0">SF_CFS_FILE_FCLOSE_ERROR</a> = 11
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4a77690c5eb7fc8973edd3f2a3a048d9ad">SF_SMALL_FILE_SIZE</a> = 12
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4a9652d75e01f85a8c943d1306e9ff2482">SF_OFFSET_FSEEK_ERROR</a> = 13
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4af45f699f07fb92dd03463c708b9286ea">SF_BUFFER_FREAD_ERROR</a> = 14
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4a2a4b00c4f9b7804235df9c4a6218a547">SF_FILE_FCLOSE_ERROR</a> = 15
, <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4ac5ea9da038bf21167935fe4dd4004853">SF_VIRUS_DETECTED</a> = 16
 }</td></tr>
<tr class="memdesc:a71294fb18b2f091cb4db120c47248cb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error codes for the <a class="el" href="#aa89d5cbcf8384ad01bd00a74da7d7d5f" title="Scans a file for a known virus signature.">scan_file()</a> function.  <a href="#a71294fb18b2f091cb4db120c47248cb4">More...</a><br /></td></tr>
<tr class="separator:a71294fb18b2f091cb4db120c47248cb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a505d9c7125a411e66685d2227d5876ca" id="r_a505d9c7125a411e66685d2227d5876ca"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a505d9c7125a411e66685d2227d5876ca">Error_Codes_Main</a> { <a class="el" href="#a505d9c7125a411e66685d2227d5876caa0ac975def3016aa1304a4fd798658c45">MAIN_SUCCESS</a> = 0
, <a class="el" href="#a505d9c7125a411e66685d2227d5876caa0dcb1ae4354f95e2960f9c1542ebd456">MAIN_SIGN_PRINTF_ERROR</a> = 1
, <a class="el" href="#a505d9c7125a411e66685d2227d5876caa173c9137cec343584f6ba48d2ec66852">MAIN_SIGN_SCANF_ERROR</a> = 2
, <a class="el" href="#a505d9c7125a411e66685d2227d5876caa4a417dbf7867f1696c6525c2c4b70fd5">MAIN_RS_PRINTF_ERROR</a> = 3
, <a class="el" href="#a505d9c7125a411e66685d2227d5876caa9dcdf42d9372703b2f2498b37a195dcc">MAIN_RS_ERROR</a> = 4
, <a class="el" href="#a505d9c7125a411e66685d2227d5876caa051f810ad358e76497c40065780a1939">MAIN_TARG_PRINTF_ERROR</a> = 5
, <a class="el" href="#a505d9c7125a411e66685d2227d5876caaa979183865601e1617961c53893b772a">MAIN_TARG_SCANF_ERROR</a> = 6
, <a class="el" href="#a505d9c7125a411e66685d2227d5876caa26eec8f2fb6c008f4d5faf977ea90c76">MAIN_OK_PRINTF_ERROR</a> = 7
, <a class="el" href="#a505d9c7125a411e66685d2227d5876caadc4189703cdc6a6d7a5fce15fd79696b">MAIN_VIRUS_PRINTF_ERROR</a> = 8
, <a class="el" href="#a505d9c7125a411e66685d2227d5876caa2d6d9903a4034508690e48adc0b49be2">MAIN_SF_PRINTF_ERROR</a> = 9
, <a class="el" href="#a505d9c7125a411e66685d2227d5876caaadcab435f8ce5aa4bda37d3db399bd87">MAIN_SF_ERROR</a> = 10
 }</td></tr>
<tr class="memdesc:a505d9c7125a411e66685d2227d5876ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error codes for the <a class="el" href="#ae66f6b31b5ad750f1fe042a706a4e3d4" title="Entry point of the antivirus scanner.">main()</a> function.  <a href="#a505d9c7125a411e66685d2227d5876ca">More...</a><br /></td></tr>
<tr class="separator:a505d9c7125a411e66685d2227d5876ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8e3328c6c60e31ff127ca888d472fb0c" id="r_a8e3328c6c60e31ff127ca888d472fb0c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8e3328c6c60e31ff127ca888d472fb0c">read_signature</a> (const char *file_path, <a class="el" href="../../d7/d46/a00002.html#d0/dc0/a00033">VirusSignature</a> *vs)</td></tr>
<tr class="memdesc:a8e3328c6c60e31ff127ca888d472fb0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads a virus signature from a file.  <br /></td></tr>
<tr class="separator:a8e3328c6c60e31ff127ca888d472fb0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac151026d2ff41253cf6e6c247eab91b1" id="r_ac151026d2ff41253cf6e6c247eab91b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac151026d2ff41253cf6e6c247eab91b1">calculate_file_size</a> (const char *file_path, size_t *file_size)</td></tr>
<tr class="memdesc:ac151026d2ff41253cf6e6c247eab91b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the size of a file.  <br /></td></tr>
<tr class="separator:ac151026d2ff41253cf6e6c247eab91b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa89d5cbcf8384ad01bd00a74da7d7d5f" id="r_aa89d5cbcf8384ad01bd00a74da7d7d5f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa89d5cbcf8384ad01bd00a74da7d7d5f">scan_file</a> (const char *file_path, <a class="el" href="../../d7/d46/a00002.html#d0/dc0/a00033">VirusSignature</a> *vs)</td></tr>
<tr class="memdesc:aa89d5cbcf8384ad01bd00a74da7d7d5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scans a file for a known virus signature.  <br /></td></tr>
<tr class="separator:aa89d5cbcf8384ad01bd00a74da7d7d5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66f6b31b5ad750f1fe042a706a4e3d4" id="r_ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a> ()</td></tr>
<tr class="memdesc:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entry point of the antivirus scanner.  <br /></td></tr>
<tr class="separator:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="d0/dc0/a00033" id="d0/dc0/a00033"></a>
<h2 class="memtitle"><span class="permalink"><a href="#d0/dc0/a00033">&#9670;&#160;</a></span>VirusSignature</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct VirusSignature</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Represents a virus signature. </p>
<p>Contains a byte array for the signature, an offset where the signature should be located, and the virus name. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/de8/a00061_source.html#l00030">30</a> of file <a class="el" href="../../d4/de8/a00061_source.html">код/kursa/antivirus.c</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a74f88d067cee336d3b43235eb3f074e8" name="a74f88d067cee336d3b43235eb3f074e8"></a>size_t</td>
<td class="fieldname">
offset</td>
<td class="fielddoc">
<p>Offset in the file where the signature is expected. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a5dd08f3395ee705f333a09ba0ac63778" name="a5dd08f3395ee705f333a09ba0ac63778"></a>unsigned char</td>
<td class="fieldname">
signature[8]</td>
<td class="fielddoc">
<p>Byte array representing the virus signature. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="abafda29c1fbbe5c07c36dcecb5d1a4d6" name="abafda29c1fbbe5c07c36dcecb5d1a4d6"></a>char</td>
<td class="fieldname">
virus_name[256]</td>
<td class="fielddoc">
<p>Name of the virus. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a58d1d45bf875bddd6dc4dadb13e11d7f" name="a58d1d45bf875bddd6dc4dadb13e11d7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58d1d45bf875bddd6dc4dadb13e11d7f">&#9670;&#160;</a></span>MAX_FILE_SYSTEM_ADRESS_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_FILE_SYSTEM_ADRESS_SIZE&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum length (in characters) of a file system path or address. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/de8/a00061_source.html#l00021">21</a> of file <a class="el" href="../../d4/de8/a00061_source.html">код/kursa/antivirus.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/de8/a00061_source.html#l00269">main()</a>.</p>

</div>
</div>
<a id="a1f9805263a7a02041237a4a990811e57" name="a1f9805263a7a02041237a4a990811e57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f9805263a7a02041237a4a990811e57">&#9670;&#160;</a></span>MAX_SIGNATURE_LENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_SIGNATURE_LENGTH&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum length (in bytes) of a virus signature. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/de8/a00061_source.html#l00011">11</a> of file <a class="el" href="../../d4/de8/a00061_source.html">код/kursa/antivirus.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/de8/a00061_source.html#l00734">scan_file()</a>.</p>

</div>
</div>
<a id="acaedbc5a6f36b71976611496f4e3a327" name="acaedbc5a6f36b71976611496f4e3a327"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaedbc5a6f36b71976611496f4e3a327">&#9670;&#160;</a></span>MAX_VIRUS_NAME_LENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_VIRUS_NAME_LENGTH&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum length (in characters) of a virus name string. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/de8/a00061_source.html#l00016">16</a> of file <a class="el" href="../../d4/de8/a00061_source.html">код/kursa/antivirus.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a6d150856ebcbc39802d95e25f1330df1" name="a6d150856ebcbc39802d95e25f1330df1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d150856ebcbc39802d95e25f1330df1">&#9670;&#160;</a></span>Error_Codes_CFS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a6d150856ebcbc39802d95e25f1330df1">Error_Codes_CFS</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Error codes for the <a class="el" href="#ac151026d2ff41253cf6e6c247eab91b1" title="Calculates the size of a file.">calculate_file_size()</a> function. </p>
<p>CFS - Calculate File Size. These error codes help to identify various issues that can occur while determining the size of a file.</p>
<dl class="section note"><dt>Note</dt><dd>Each error code corresponds to a specific failure during file handling or file size calculation.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ac151026d2ff41253cf6e6c247eab91b1" title="Calculates the size of a file.">calculate_file_size()</a> for function utilizing these error codes. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="#a6d150856ebcbc39802d95e25f1330df1" title="Error codes for the calculate_file_size() function.">Error_Codes_CFS</a></td><td>See the enum for possible return values. </td></tr>
  </table>
  </dd>
</dl>
<table class="fieldtable">
<tr><th colspan="3">Enumerator</th></tr><tr><td class="fieldname"><a id="a6d150856ebcbc39802d95e25f1330df1ad622e94493a882562592bbe767353b71" name="a6d150856ebcbc39802d95e25f1330df1ad622e94493a882562592bbe767353b71"></a>CFS_SUCCESS&#160;</td><td class="fieldinit">0&#160;</td><td class="fielddoc"><p>The operation completed successfully. </p>
<p>No errors. </p>
</td></tr>
<tr><td class="fieldname"><a id="a6d150856ebcbc39802d95e25f1330df1a6d718b6f23a18eaefa43664ee3dc763d" name="a6d150856ebcbc39802d95e25f1330df1a6d718b6f23a18eaefa43664ee3dc763d"></a>CFS_NULL_FILE_PATH_POINTER&#160;</td><td class="fieldinit">1&#160;</td><td class="fielddoc"><p>The file path argument is NULL. </p>
<p>First argument (file path) is NULL. </p>
</td></tr>
<tr><td class="fieldname"><a id="a6d150856ebcbc39802d95e25f1330df1a8b09752e65b1530123e2460d6536492d" name="a6d150856ebcbc39802d95e25f1330df1a8b09752e65b1530123e2460d6536492d"></a>CFS_NULL_FILE_SIZE_POINTER&#160;</td><td class="fieldinit">2&#160;</td><td class="fielddoc"><p>The file size pointer argument is NULL. </p>
<p>Second argument (file size pointer) is NULL. </p>
</td></tr>
<tr><td class="fieldname"><a id="a6d150856ebcbc39802d95e25f1330df1a1f73fee4befb453fa5534f53c04a6d5b" name="a6d150856ebcbc39802d95e25f1330df1a1f73fee4befb453fa5534f53c04a6d5b"></a>CFS_FILE_FOPEN_ERROR&#160;</td><td class="fieldinit">3&#160;</td><td class="fielddoc"><p>The file could not be opened. </p>
<p>Failed to open the file. </p>
</td></tr>
<tr><td class="fieldname"><a id="a6d150856ebcbc39802d95e25f1330df1ad5c83b632548a90f3febe7168cc29e7d" name="a6d150856ebcbc39802d95e25f1330df1ad5c83b632548a90f3febe7168cc29e7d"></a>CFS_END_FSEEK_ERROR&#160;</td><td class="fieldinit">4&#160;</td><td class="fielddoc"><p>Failed to set file position to the end of the file. </p>
<p>Failed to set the file position to the end using fseek. </p>
</td></tr>
<tr><td class="fieldname"><a id="a6d150856ebcbc39802d95e25f1330df1aab1185a29decc2242b01e17afb12e435" name="a6d150856ebcbc39802d95e25f1330df1aab1185a29decc2242b01e17afb12e435"></a>CFS_SIZE_FTELL_ERROR&#160;</td><td class="fieldinit">5&#160;</td><td class="fielddoc"><p>Failed to obtain the current value of the file-position indicator. </p>
<p>Failed to get the current position using ftell. </p>
</td></tr>
<tr><td class="fieldname"><a id="a6d150856ebcbc39802d95e25f1330df1aafb51e061b61c1f662dc5c3dddf19366" name="a6d150856ebcbc39802d95e25f1330df1aafb51e061b61c1f662dc5c3dddf19366"></a>CFS_FILE_FCLOSE_ERROR&#160;</td><td class="fieldinit">6&#160;</td><td class="fielddoc"><p>The file could not be closed properly. </p>
<p>Failed to close the file descriptor. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d4/de8/a00061_source.html#l00109">109</a> of file <a class="el" href="../../d4/de8/a00061_source.html">код/kursa/antivirus.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  110</span>{</div>
<div class="line"><span class="lineno">  112</span>    <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1ad622e94493a882562592bbe767353b71">CFS_SUCCESS</a> = 0, </div>
<div class="line"><span class="lineno">  113</span></div>
<div class="line"><span class="lineno">  115</span>    <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1a6d718b6f23a18eaefa43664ee3dc763d">CFS_NULL_FILE_PATH_POINTER</a> = 1, </div>
<div class="line"><span class="lineno">  116</span></div>
<div class="line"><span class="lineno">  118</span>    <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1a8b09752e65b1530123e2460d6536492d">CFS_NULL_FILE_SIZE_POINTER</a> = 2, </div>
<div class="line"><span class="lineno">  119</span></div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1a1f73fee4befb453fa5534f53c04a6d5b">CFS_FILE_FOPEN_ERROR</a> = 3, </div>
<div class="line"><span class="lineno">  122</span></div>
<div class="line"><span class="lineno">  124</span>    <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1ad5c83b632548a90f3febe7168cc29e7d">CFS_END_FSEEK_ERROR</a> = 4, </div>
<div class="line"><span class="lineno">  125</span></div>
<div class="line"><span class="lineno">  127</span>    <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1aab1185a29decc2242b01e17afb12e435">CFS_SIZE_FTELL_ERROR</a> = 5, </div>
<div class="line"><span class="lineno">  128</span></div>
<div class="line"><span class="lineno">  130</span>    <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1aafb51e061b61c1f662dc5c3dddf19366">CFS_FILE_FCLOSE_ERROR</a> = 6 </div>
<div class="line"><span class="lineno">  131</span>};</div>
<div class="ttc" id="aa00061_html_a6d150856ebcbc39802d95e25f1330df1a1f73fee4befb453fa5534f53c04a6d5b"><div class="ttname"><a href="#a6d150856ebcbc39802d95e25f1330df1a1f73fee4befb453fa5534f53c04a6d5b">CFS_FILE_FOPEN_ERROR</a></div><div class="ttdeci">@ CFS_FILE_FOPEN_ERROR</div><div class="ttdoc">The file could not be opened.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00121">код/kursa/antivirus.c:121</a></div></div>
<div class="ttc" id="aa00061_html_a6d150856ebcbc39802d95e25f1330df1a6d718b6f23a18eaefa43664ee3dc763d"><div class="ttname"><a href="#a6d150856ebcbc39802d95e25f1330df1a6d718b6f23a18eaefa43664ee3dc763d">CFS_NULL_FILE_PATH_POINTER</a></div><div class="ttdeci">@ CFS_NULL_FILE_PATH_POINTER</div><div class="ttdoc">The file path argument is NULL.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00115">код/kursa/antivirus.c:115</a></div></div>
<div class="ttc" id="aa00061_html_a6d150856ebcbc39802d95e25f1330df1a8b09752e65b1530123e2460d6536492d"><div class="ttname"><a href="#a6d150856ebcbc39802d95e25f1330df1a8b09752e65b1530123e2460d6536492d">CFS_NULL_FILE_SIZE_POINTER</a></div><div class="ttdeci">@ CFS_NULL_FILE_SIZE_POINTER</div><div class="ttdoc">The file size pointer argument is NULL.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00118">код/kursa/antivirus.c:118</a></div></div>
<div class="ttc" id="aa00061_html_a6d150856ebcbc39802d95e25f1330df1aab1185a29decc2242b01e17afb12e435"><div class="ttname"><a href="#a6d150856ebcbc39802d95e25f1330df1aab1185a29decc2242b01e17afb12e435">CFS_SIZE_FTELL_ERROR</a></div><div class="ttdeci">@ CFS_SIZE_FTELL_ERROR</div><div class="ttdoc">Failed to obtain the current value of the file-position indicator.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00127">код/kursa/antivirus.c:127</a></div></div>
<div class="ttc" id="aa00061_html_a6d150856ebcbc39802d95e25f1330df1aafb51e061b61c1f662dc5c3dddf19366"><div class="ttname"><a href="#a6d150856ebcbc39802d95e25f1330df1aafb51e061b61c1f662dc5c3dddf19366">CFS_FILE_FCLOSE_ERROR</a></div><div class="ttdeci">@ CFS_FILE_FCLOSE_ERROR</div><div class="ttdoc">The file could not be closed properly.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00130">код/kursa/antivirus.c:130</a></div></div>
<div class="ttc" id="aa00061_html_a6d150856ebcbc39802d95e25f1330df1ad5c83b632548a90f3febe7168cc29e7d"><div class="ttname"><a href="#a6d150856ebcbc39802d95e25f1330df1ad5c83b632548a90f3febe7168cc29e7d">CFS_END_FSEEK_ERROR</a></div><div class="ttdeci">@ CFS_END_FSEEK_ERROR</div><div class="ttdoc">Failed to set file position to the end of the file.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00124">код/kursa/antivirus.c:124</a></div></div>
<div class="ttc" id="aa00061_html_a6d150856ebcbc39802d95e25f1330df1ad622e94493a882562592bbe767353b71"><div class="ttname"><a href="#a6d150856ebcbc39802d95e25f1330df1ad622e94493a882562592bbe767353b71">CFS_SUCCESS</a></div><div class="ttdeci">@ CFS_SUCCESS</div><div class="ttdoc">The operation completed successfully.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00112">код/kursa/antivirus.c:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a505d9c7125a411e66685d2227d5876ca" name="a505d9c7125a411e66685d2227d5876ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a505d9c7125a411e66685d2227d5876ca">&#9670;&#160;</a></span>Error_Codes_Main</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a505d9c7125a411e66685d2227d5876ca">Error_Codes_Main</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Error codes for the <a class="el" href="#ae66f6b31b5ad750f1fe042a706a4e3d4" title="Entry point of the antivirus scanner.">main()</a> function. </p>
<p>MAIN - General errors related to program input/output or called subroutines.</p>
<p>These error codes represent various failure cases encountered during the execution of the main function, including issues with printing messages, reading files, and invoking specific subroutines (e.g., Read_Signature and Scan_File).</p>
<dl class="section note"><dt>Note</dt><dd>These error codes help to diagnose and handle issues related to input/output operations, file scanning, and printing results to the user.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ae66f6b31b5ad750f1fe042a706a4e3d4" title="Entry point of the antivirus scanner.">main()</a> for the function utilizing these error codes. </dd></dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="#a505d9c7125a411e66685d2227d5876ca" title="Error codes for the main() function.">Error_Codes_Main</a> See the enum for possible return values. </dd></dl>
<table class="fieldtable">
<tr><th colspan="3">Enumerator</th></tr><tr><td class="fieldname"><a id="a505d9c7125a411e66685d2227d5876caa0ac975def3016aa1304a4fd798658c45" name="a505d9c7125a411e66685d2227d5876caa0ac975def3016aa1304a4fd798658c45"></a>MAIN_SUCCESS&#160;</td><td class="fieldinit">0&#160;</td><td class="fielddoc"><p>The main function executed successfully. </p>
<p>No errors, program ran successfully. </p>
</td></tr>
<tr><td class="fieldname"><a id="a505d9c7125a411e66685d2227d5876caa0dcb1ae4354f95e2960f9c1542ebd456" name="a505d9c7125a411e66685d2227d5876caa0dcb1ae4354f95e2960f9c1542ebd456"></a>MAIN_SIGN_PRINTF_ERROR&#160;</td><td class="fieldinit">1&#160;</td><td class="fielddoc"><p>Failed to print the signature file message. </p>
<p>Error while printing the signature file message. </p>
</td></tr>
<tr><td class="fieldname"><a id="a505d9c7125a411e66685d2227d5876caa173c9137cec343584f6ba48d2ec66852" name="a505d9c7125a411e66685d2227d5876caa173c9137cec343584f6ba48d2ec66852"></a>MAIN_SIGN_SCANF_ERROR&#160;</td><td class="fieldinit">2&#160;</td><td class="fielddoc"><p>Failed to scan the signature file path. </p>
<p>Error while scanning the signature file path. </p>
</td></tr>
<tr><td class="fieldname"><a id="a505d9c7125a411e66685d2227d5876caa4a417dbf7867f1696c6525c2c4b70fd5" name="a505d9c7125a411e66685d2227d5876caa4a417dbf7867f1696c6525c2c4b70fd5"></a>MAIN_RS_PRINTF_ERROR&#160;</td><td class="fieldinit">3&#160;</td><td class="fielddoc"><p>Failed to print the error message related to Read_Signature. </p>
<p>Error while printing the Read_Signature function error message. </p>
</td></tr>
<tr><td class="fieldname"><a id="a505d9c7125a411e66685d2227d5876caa9dcdf42d9372703b2f2498b37a195dcc" name="a505d9c7125a411e66685d2227d5876caa9dcdf42d9372703b2f2498b37a195dcc"></a>MAIN_RS_ERROR&#160;</td><td class="fieldinit">4&#160;</td><td class="fielddoc"><p>An error occurred in the Read_Signature (RS) function. </p>
<p>Error during execution of the Read_Signature function. </p>
</td></tr>
<tr><td class="fieldname"><a id="a505d9c7125a411e66685d2227d5876caa051f810ad358e76497c40065780a1939" name="a505d9c7125a411e66685d2227d5876caa051f810ad358e76497c40065780a1939"></a>MAIN_TARG_PRINTF_ERROR&#160;</td><td class="fieldinit">5&#160;</td><td class="fielddoc"><p>Failed to print the target file message. </p>
<p>Error while printing the target file message. </p>
</td></tr>
<tr><td class="fieldname"><a id="a505d9c7125a411e66685d2227d5876caaa979183865601e1617961c53893b772a" name="a505d9c7125a411e66685d2227d5876caaa979183865601e1617961c53893b772a"></a>MAIN_TARG_SCANF_ERROR&#160;</td><td class="fieldinit">6&#160;</td><td class="fielddoc"><p>Failed to scan the target file path for possible virus. </p>
<p>Error while scanning the target file path. </p>
</td></tr>
<tr><td class="fieldname"><a id="a505d9c7125a411e66685d2227d5876caa26eec8f2fb6c008f4d5faf977ea90c76" name="a505d9c7125a411e66685d2227d5876caa26eec8f2fb6c008f4d5faf977ea90c76"></a>MAIN_OK_PRINTF_ERROR&#160;</td><td class="fieldinit">7&#160;</td><td class="fielddoc"><p>Failed to print that the file is safe. </p>
<p>Error while printing that the file is safe. </p>
</td></tr>
<tr><td class="fieldname"><a id="a505d9c7125a411e66685d2227d5876caadc4189703cdc6a6d7a5fce15fd79696b" name="a505d9c7125a411e66685d2227d5876caadc4189703cdc6a6d7a5fce15fd79696b"></a>MAIN_VIRUS_PRINTF_ERROR&#160;</td><td class="fieldinit">8&#160;</td><td class="fielddoc"><p>Failed to print that the file is not safe. </p>
<p>Error while printing that the file contains a virus. </p>
</td></tr>
<tr><td class="fieldname"><a id="a505d9c7125a411e66685d2227d5876caa2d6d9903a4034508690e48adc0b49be2" name="a505d9c7125a411e66685d2227d5876caa2d6d9903a4034508690e48adc0b49be2"></a>MAIN_SF_PRINTF_ERROR&#160;</td><td class="fieldinit">9&#160;</td><td class="fielddoc"><p>Failed to print the error message from Scan_File. </p>
<p>Error while printing the Scan_File error message. </p>
</td></tr>
<tr><td class="fieldname"><a id="a505d9c7125a411e66685d2227d5876caaadcab435f8ce5aa4bda37d3db399bd87" name="a505d9c7125a411e66685d2227d5876caaadcab435f8ce5aa4bda37d3db399bd87"></a>MAIN_SF_ERROR&#160;</td><td class="fieldinit">10&#160;</td><td class="fielddoc"><p>An error occurred during the Scan_File (SF) function. </p>
<p>Error during execution of the Scan_File function. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d4/de8/a00061_source.html#l00218">218</a> of file <a class="el" href="../../d4/de8/a00061_source.html">код/kursa/antivirus.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  219</span>{</div>
<div class="line"><span class="lineno">  221</span>    <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa0ac975def3016aa1304a4fd798658c45">MAIN_SUCCESS</a> = 0, </div>
<div class="line"><span class="lineno">  222</span></div>
<div class="line"><span class="lineno">  224</span>    <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa0dcb1ae4354f95e2960f9c1542ebd456">MAIN_SIGN_PRINTF_ERROR</a> = 1, </div>
<div class="line"><span class="lineno">  225</span></div>
<div class="line"><span class="lineno">  227</span>    <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa173c9137cec343584f6ba48d2ec66852">MAIN_SIGN_SCANF_ERROR</a> = 2, </div>
<div class="line"><span class="lineno">  228</span></div>
<div class="line"><span class="lineno">  230</span>    <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa4a417dbf7867f1696c6525c2c4b70fd5">MAIN_RS_PRINTF_ERROR</a> = 3, </div>
<div class="line"><span class="lineno">  231</span></div>
<div class="line"><span class="lineno">  233</span>    <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa9dcdf42d9372703b2f2498b37a195dcc">MAIN_RS_ERROR</a> = 4, </div>
<div class="line"><span class="lineno">  234</span></div>
<div class="line"><span class="lineno">  236</span>    <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa051f810ad358e76497c40065780a1939">MAIN_TARG_PRINTF_ERROR</a> = 5, </div>
<div class="line"><span class="lineno">  237</span></div>
<div class="line"><span class="lineno">  239</span>    <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caaa979183865601e1617961c53893b772a">MAIN_TARG_SCANF_ERROR</a> = 6, </div>
<div class="line"><span class="lineno">  240</span></div>
<div class="line"><span class="lineno">  242</span>    <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa26eec8f2fb6c008f4d5faf977ea90c76">MAIN_OK_PRINTF_ERROR</a> = 7, </div>
<div class="line"><span class="lineno">  243</span></div>
<div class="line"><span class="lineno">  245</span>    <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caadc4189703cdc6a6d7a5fce15fd79696b">MAIN_VIRUS_PRINTF_ERROR</a> = 8, </div>
<div class="line"><span class="lineno">  246</span></div>
<div class="line"><span class="lineno">  248</span>    <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa2d6d9903a4034508690e48adc0b49be2">MAIN_SF_PRINTF_ERROR</a> = 9, </div>
<div class="line"><span class="lineno">  249</span></div>
<div class="line"><span class="lineno">  251</span>    <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caaadcab435f8ce5aa4bda37d3db399bd87">MAIN_SF_ERROR</a> = 10 </div>
<div class="line"><span class="lineno">  252</span>};</div>
<div class="ttc" id="aa00061_html_a505d9c7125a411e66685d2227d5876caa051f810ad358e76497c40065780a1939"><div class="ttname"><a href="#a505d9c7125a411e66685d2227d5876caa051f810ad358e76497c40065780a1939">MAIN_TARG_PRINTF_ERROR</a></div><div class="ttdeci">@ MAIN_TARG_PRINTF_ERROR</div><div class="ttdoc">Failed to print the target file message.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00236">код/kursa/antivirus.c:236</a></div></div>
<div class="ttc" id="aa00061_html_a505d9c7125a411e66685d2227d5876caa0ac975def3016aa1304a4fd798658c45"><div class="ttname"><a href="#a505d9c7125a411e66685d2227d5876caa0ac975def3016aa1304a4fd798658c45">MAIN_SUCCESS</a></div><div class="ttdeci">@ MAIN_SUCCESS</div><div class="ttdoc">The main function executed successfully.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00221">код/kursa/antivirus.c:221</a></div></div>
<div class="ttc" id="aa00061_html_a505d9c7125a411e66685d2227d5876caa0dcb1ae4354f95e2960f9c1542ebd456"><div class="ttname"><a href="#a505d9c7125a411e66685d2227d5876caa0dcb1ae4354f95e2960f9c1542ebd456">MAIN_SIGN_PRINTF_ERROR</a></div><div class="ttdeci">@ MAIN_SIGN_PRINTF_ERROR</div><div class="ttdoc">Failed to print the signature file message.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00224">код/kursa/antivirus.c:224</a></div></div>
<div class="ttc" id="aa00061_html_a505d9c7125a411e66685d2227d5876caa173c9137cec343584f6ba48d2ec66852"><div class="ttname"><a href="#a505d9c7125a411e66685d2227d5876caa173c9137cec343584f6ba48d2ec66852">MAIN_SIGN_SCANF_ERROR</a></div><div class="ttdeci">@ MAIN_SIGN_SCANF_ERROR</div><div class="ttdoc">Failed to scan the signature file path.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00227">код/kursa/antivirus.c:227</a></div></div>
<div class="ttc" id="aa00061_html_a505d9c7125a411e66685d2227d5876caa26eec8f2fb6c008f4d5faf977ea90c76"><div class="ttname"><a href="#a505d9c7125a411e66685d2227d5876caa26eec8f2fb6c008f4d5faf977ea90c76">MAIN_OK_PRINTF_ERROR</a></div><div class="ttdeci">@ MAIN_OK_PRINTF_ERROR</div><div class="ttdoc">Failed to print that the file is safe.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00242">код/kursa/antivirus.c:242</a></div></div>
<div class="ttc" id="aa00061_html_a505d9c7125a411e66685d2227d5876caa2d6d9903a4034508690e48adc0b49be2"><div class="ttname"><a href="#a505d9c7125a411e66685d2227d5876caa2d6d9903a4034508690e48adc0b49be2">MAIN_SF_PRINTF_ERROR</a></div><div class="ttdeci">@ MAIN_SF_PRINTF_ERROR</div><div class="ttdoc">Failed to print the error message from Scan_File.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00248">код/kursa/antivirus.c:248</a></div></div>
<div class="ttc" id="aa00061_html_a505d9c7125a411e66685d2227d5876caa4a417dbf7867f1696c6525c2c4b70fd5"><div class="ttname"><a href="#a505d9c7125a411e66685d2227d5876caa4a417dbf7867f1696c6525c2c4b70fd5">MAIN_RS_PRINTF_ERROR</a></div><div class="ttdeci">@ MAIN_RS_PRINTF_ERROR</div><div class="ttdoc">Failed to print the error message related to Read_Signature.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00230">код/kursa/antivirus.c:230</a></div></div>
<div class="ttc" id="aa00061_html_a505d9c7125a411e66685d2227d5876caa9dcdf42d9372703b2f2498b37a195dcc"><div class="ttname"><a href="#a505d9c7125a411e66685d2227d5876caa9dcdf42d9372703b2f2498b37a195dcc">MAIN_RS_ERROR</a></div><div class="ttdeci">@ MAIN_RS_ERROR</div><div class="ttdoc">An error occurred in the Read_Signature (RS) function.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00233">код/kursa/antivirus.c:233</a></div></div>
<div class="ttc" id="aa00061_html_a505d9c7125a411e66685d2227d5876caaa979183865601e1617961c53893b772a"><div class="ttname"><a href="#a505d9c7125a411e66685d2227d5876caaa979183865601e1617961c53893b772a">MAIN_TARG_SCANF_ERROR</a></div><div class="ttdeci">@ MAIN_TARG_SCANF_ERROR</div><div class="ttdoc">Failed to scan the target file path for possible virus.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00239">код/kursa/antivirus.c:239</a></div></div>
<div class="ttc" id="aa00061_html_a505d9c7125a411e66685d2227d5876caaadcab435f8ce5aa4bda37d3db399bd87"><div class="ttname"><a href="#a505d9c7125a411e66685d2227d5876caaadcab435f8ce5aa4bda37d3db399bd87">MAIN_SF_ERROR</a></div><div class="ttdeci">@ MAIN_SF_ERROR</div><div class="ttdoc">An error occurred during the Scan_File (SF) function.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00251">код/kursa/antivirus.c:251</a></div></div>
<div class="ttc" id="aa00061_html_a505d9c7125a411e66685d2227d5876caadc4189703cdc6a6d7a5fce15fd79696b"><div class="ttname"><a href="#a505d9c7125a411e66685d2227d5876caadc4189703cdc6a6d7a5fce15fd79696b">MAIN_VIRUS_PRINTF_ERROR</a></div><div class="ttdeci">@ MAIN_VIRUS_PRINTF_ERROR</div><div class="ttdoc">Failed to print that the file is not safe.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00245">код/kursa/antivirus.c:245</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55394e67b4669c9f3d522ff7d354487c" name="a55394e67b4669c9f3d522ff7d354487c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55394e67b4669c9f3d522ff7d354487c">&#9670;&#160;</a></span>Error_Codes_RS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a55394e67b4669c9f3d522ff7d354487c">Error_Codes_RS</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Here is a list of all enums with links to the files they belong to: </p>
<ul>
<li>The error naming convention follows this pattern: The error is named by the current function (CF) + the error function (EF) = CF_VARIABLE_EF_ERROR: Example: Error with the OFFSET variable in the FSCANF function. RS - Read Signature (current function), fscanf(file, "%zx", &amp;vs-&gt;offset) - error function. The error name will be: RS_OFFSET_FSCANF_ERROR.</li>
<li>If there is an error with the variable value, the following naming convention is used: Current function (CF) + error value (EV) + variable name (VN) = CF_EV_VN: Example: Error with the variable FILE_PATH (VN) - NULL POINTER (EV) in the current function RS (Read Signature; CF). The error will be named: RS_NULL_FILE_PATH_POINTER.</li>
<li>For special return values, I will also use an enum for simplification.</li>
</ul>
<p>Error codes for the read_signature function.</p>
<p>These codes represent different failure scenarios that might occur when reading a virus signature from a file.</p>
<dl class="section note"><dt>Note</dt><dd>Each error code corresponds to a specific issue during file handling or signature parsing. Use these error codes to troubleshoot issues with file reading operations in the <code>ReadSignature</code> function.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a8e3328c6c60e31ff127ca888d472fb0c" title="Reads a virus signature from a file.">read_signature()</a> for function utilizing these error codes. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="#a55394e67b4669c9f3d522ff7d354487c" title="Here is a list of all enums with links to the files they belong to:">Error_Codes_RS</a></td><td>See the enum for possible return values. </td></tr>
  </table>
  </dd>
</dl>
<table class="fieldtable">
<tr><th colspan="3">Enumerator</th></tr><tr><td class="fieldname"><a id="a55394e67b4669c9f3d522ff7d354487cadb1dd6134c0f933bc9659935942d908f" name="a55394e67b4669c9f3d522ff7d354487cadb1dd6134c0f933bc9659935942d908f"></a>RS_SUCCESS&#160;</td><td class="fieldinit">0&#160;</td><td class="fielddoc"><p>No errors, operation completed successfully. </p>
</td></tr>
<tr><td class="fieldname"><a id="a55394e67b4669c9f3d522ff7d354487cad5c1ee2dcd3eced7b598f0f7eddde9ce" name="a55394e67b4669c9f3d522ff7d354487cad5c1ee2dcd3eced7b598f0f7eddde9ce"></a>RS_NULL_FILE_PATH_POINTER&#160;</td><td class="fieldinit">1&#160;</td><td class="fielddoc"><p>File path argument is NULL. </p>
</td></tr>
<tr><td class="fieldname"><a id="a55394e67b4669c9f3d522ff7d354487ca22802c47292e70b0a339ff994b7907c9" name="a55394e67b4669c9f3d522ff7d354487ca22802c47292e70b0a339ff994b7907c9"></a>RS_NULL_VSTRUCT_POINTER&#160;</td><td class="fieldinit">2&#160;</td><td class="fielddoc"><p>Virus structure pointer is NULL. </p>
</td></tr>
<tr><td class="fieldname"><a id="a55394e67b4669c9f3d522ff7d354487ca72f057ce83550944e650aaac64734965" name="a55394e67b4669c9f3d522ff7d354487ca72f057ce83550944e650aaac64734965"></a>RS_FILE_FOPEN_ERROR&#160;</td><td class="fieldinit">3&#160;</td><td class="fielddoc"><p>Failed to open file. </p>
</td></tr>
<tr><td class="fieldname"><a id="a55394e67b4669c9f3d522ff7d354487ca4e716b355dce153ee5b2ff3fd2bfccd1" name="a55394e67b4669c9f3d522ff7d354487ca4e716b355dce153ee5b2ff3fd2bfccd1"></a>RS_SIGNATURE_FSCANF_ERROR&#160;</td><td class="fieldinit">4&#160;</td><td class="fielddoc"><p>Failed to read signature from file. </p>
</td></tr>
<tr><td class="fieldname"><a id="a55394e67b4669c9f3d522ff7d354487cae61710028a61c4d375b610bf6d821469" name="a55394e67b4669c9f3d522ff7d354487cae61710028a61c4d375b610bf6d821469"></a>RS_OFFSET_FSCANF_ERROR&#160;</td><td class="fieldinit">5&#160;</td><td class="fielddoc"><p>Failed to set file-position-indicator (offset). </p>
</td></tr>
<tr><td class="fieldname"><a id="a55394e67b4669c9f3d522ff7d354487ca5bab52062e9e8a25d41337700a267d51" name="a55394e67b4669c9f3d522ff7d354487ca5bab52062e9e8a25d41337700a267d51"></a>RS_VNAME_FSCANF_ERROR&#160;</td><td class="fieldinit">6&#160;</td><td class="fielddoc"><p>Failed to read virus name from file. </p>
</td></tr>
<tr><td class="fieldname"><a id="a55394e67b4669c9f3d522ff7d354487ca0cda8a27dadca17b568a928144060c83" name="a55394e67b4669c9f3d522ff7d354487ca0cda8a27dadca17b568a928144060c83"></a>RS_FILE_FCLOSE_ERROR&#160;</td><td class="fieldinit">7&#160;</td><td class="fielddoc"><p>Failed to close file descriptor. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d4/de8/a00061_source.html#l00068">68</a> of file <a class="el" href="../../d4/de8/a00061_source.html">код/kursa/antivirus.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   69</span>{</div>
<div class="line"><span class="lineno">   71</span>    <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487cadb1dd6134c0f933bc9659935942d908f">RS_SUCCESS</a> = 0,</div>
<div class="line"><span class="lineno">   72</span></div>
<div class="line"><span class="lineno">   74</span>    <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487cad5c1ee2dcd3eced7b598f0f7eddde9ce">RS_NULL_FILE_PATH_POINTER</a> = 1,</div>
<div class="line"><span class="lineno">   75</span></div>
<div class="line"><span class="lineno">   77</span>    <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487ca22802c47292e70b0a339ff994b7907c9">RS_NULL_VSTRUCT_POINTER</a> = 2,</div>
<div class="line"><span class="lineno">   78</span></div>
<div class="line"><span class="lineno">   80</span>    <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487ca72f057ce83550944e650aaac64734965">RS_FILE_FOPEN_ERROR</a> = 3,</div>
<div class="line"><span class="lineno">   81</span></div>
<div class="line"><span class="lineno">   83</span>    <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487ca4e716b355dce153ee5b2ff3fd2bfccd1">RS_SIGNATURE_FSCANF_ERROR</a> = 4,</div>
<div class="line"><span class="lineno">   84</span></div>
<div class="line"><span class="lineno">   86</span>    <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487cae61710028a61c4d375b610bf6d821469">RS_OFFSET_FSCANF_ERROR</a> = 5,</div>
<div class="line"><span class="lineno">   87</span></div>
<div class="line"><span class="lineno">   89</span>    <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487ca5bab52062e9e8a25d41337700a267d51">RS_VNAME_FSCANF_ERROR</a> = 6,</div>
<div class="line"><span class="lineno">   90</span></div>
<div class="line"><span class="lineno">   92</span>    <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487ca0cda8a27dadca17b568a928144060c83">RS_FILE_FCLOSE_ERROR</a> = 7</div>
<div class="line"><span class="lineno">   93</span>};</div>
<div class="ttc" id="aa00061_html_a55394e67b4669c9f3d522ff7d354487ca0cda8a27dadca17b568a928144060c83"><div class="ttname"><a href="#a55394e67b4669c9f3d522ff7d354487ca0cda8a27dadca17b568a928144060c83">RS_FILE_FCLOSE_ERROR</a></div><div class="ttdeci">@ RS_FILE_FCLOSE_ERROR</div><div class="ttdoc">Failed to close file descriptor.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00092">код/kursa/antivirus.c:92</a></div></div>
<div class="ttc" id="aa00061_html_a55394e67b4669c9f3d522ff7d354487ca22802c47292e70b0a339ff994b7907c9"><div class="ttname"><a href="#a55394e67b4669c9f3d522ff7d354487ca22802c47292e70b0a339ff994b7907c9">RS_NULL_VSTRUCT_POINTER</a></div><div class="ttdeci">@ RS_NULL_VSTRUCT_POINTER</div><div class="ttdoc">Virus structure pointer is NULL.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00077">код/kursa/antivirus.c:77</a></div></div>
<div class="ttc" id="aa00061_html_a55394e67b4669c9f3d522ff7d354487ca4e716b355dce153ee5b2ff3fd2bfccd1"><div class="ttname"><a href="#a55394e67b4669c9f3d522ff7d354487ca4e716b355dce153ee5b2ff3fd2bfccd1">RS_SIGNATURE_FSCANF_ERROR</a></div><div class="ttdeci">@ RS_SIGNATURE_FSCANF_ERROR</div><div class="ttdoc">Failed to read signature from file.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00083">код/kursa/antivirus.c:83</a></div></div>
<div class="ttc" id="aa00061_html_a55394e67b4669c9f3d522ff7d354487ca5bab52062e9e8a25d41337700a267d51"><div class="ttname"><a href="#a55394e67b4669c9f3d522ff7d354487ca5bab52062e9e8a25d41337700a267d51">RS_VNAME_FSCANF_ERROR</a></div><div class="ttdeci">@ RS_VNAME_FSCANF_ERROR</div><div class="ttdoc">Failed to read virus name from file.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00089">код/kursa/antivirus.c:89</a></div></div>
<div class="ttc" id="aa00061_html_a55394e67b4669c9f3d522ff7d354487ca72f057ce83550944e650aaac64734965"><div class="ttname"><a href="#a55394e67b4669c9f3d522ff7d354487ca72f057ce83550944e650aaac64734965">RS_FILE_FOPEN_ERROR</a></div><div class="ttdeci">@ RS_FILE_FOPEN_ERROR</div><div class="ttdoc">Failed to open file.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00080">код/kursa/antivirus.c:80</a></div></div>
<div class="ttc" id="aa00061_html_a55394e67b4669c9f3d522ff7d354487cad5c1ee2dcd3eced7b598f0f7eddde9ce"><div class="ttname"><a href="#a55394e67b4669c9f3d522ff7d354487cad5c1ee2dcd3eced7b598f0f7eddde9ce">RS_NULL_FILE_PATH_POINTER</a></div><div class="ttdeci">@ RS_NULL_FILE_PATH_POINTER</div><div class="ttdoc">File path argument is NULL.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00074">код/kursa/antivirus.c:74</a></div></div>
<div class="ttc" id="aa00061_html_a55394e67b4669c9f3d522ff7d354487cadb1dd6134c0f933bc9659935942d908f"><div class="ttname"><a href="#a55394e67b4669c9f3d522ff7d354487cadb1dd6134c0f933bc9659935942d908f">RS_SUCCESS</a></div><div class="ttdeci">@ RS_SUCCESS</div><div class="ttdoc">No errors, operation completed successfully.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00071">код/kursa/antivirus.c:71</a></div></div>
<div class="ttc" id="aa00061_html_a55394e67b4669c9f3d522ff7d354487cae61710028a61c4d375b610bf6d821469"><div class="ttname"><a href="#a55394e67b4669c9f3d522ff7d354487cae61710028a61c4d375b610bf6d821469">RS_OFFSET_FSCANF_ERROR</a></div><div class="ttdeci">@ RS_OFFSET_FSCANF_ERROR</div><div class="ttdoc">Failed to set file-position-indicator (offset).</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00086">код/kursa/antivirus.c:86</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a71294fb18b2f091cb4db120c47248cb4" name="a71294fb18b2f091cb4db120c47248cb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71294fb18b2f091cb4db120c47248cb4">&#9670;&#160;</a></span>Error_Codes_SF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4">Error_Codes_SF</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Error codes for the <a class="el" href="#aa89d5cbcf8384ad01bd00a74da7d7d5f" title="Scans a file for a known virus signature.">scan_file()</a> function. </p>
<p>SF - Scan File. These error codes are used to report results and errors during the process of scanning a file for virus signatures.</p>
<dl class="section note"><dt>Note</dt><dd>These error codes are specifically associated with the scanning process and help in identifying different types of failures or issues during file scanning.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#aa89d5cbcf8384ad01bd00a74da7d7d5f" title="Scans a file for a known virus signature.">scan_file()</a> for function utilizing these error codes. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="#a71294fb18b2f091cb4db120c47248cb4" title="Error codes for the scan_file() function.">Error_Codes_SF</a></td><td>See the enum for possible return values. </td></tr>
  </table>
  </dd>
</dl>
<table class="fieldtable">
<tr><th colspan="3">Enumerator</th></tr><tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4ae8c7a0c90e729ec8abeb076a020a549e" name="a71294fb18b2f091cb4db120c47248cb4ae8c7a0c90e729ec8abeb076a020a549e"></a>SF_SUCCESS&#160;</td><td class="fieldinit">0&#160;</td><td class="fielddoc"><p>The file scan was successful, no issues encountered. </p>
<p>No errors, scanning completed successfully. </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4a83e9a4b31aea3d4bab1534d67bd8fac1" name="a71294fb18b2f091cb4db120c47248cb4a83e9a4b31aea3d4bab1534d67bd8fac1"></a>SF_NULL_FILE_PATH_POINTER&#160;</td><td class="fieldinit">1&#160;</td><td class="fielddoc"><p>The file path argument is NULL. </p>
<p>The first argument (file path) is NULL. </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4a83af1a50193d6dbcda3c5c1d9bdb554d" name="a71294fb18b2f091cb4db120c47248cb4a83af1a50193d6dbcda3c5c1d9bdb554d"></a>SF_NULL_VSTRUCT_POINTER&#160;</td><td class="fieldinit">2&#160;</td><td class="fielddoc"><p>The virus structure pointer is NULL. </p>
<p>The second argument (virus structure pointer) is NULL. </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4a5f412aaaa3f73e6ab637f802ee3c70dc" name="a71294fb18b2f091cb4db120c47248cb4a5f412aaaa3f73e6ab637f802ee3c70dc"></a>SF_FILE_FOPEN_ERROR&#160;</td><td class="fieldinit">3&#160;</td><td class="fielddoc"><p>The file could not be opened. </p>
<p>Failed to open the file. </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4aaf13c1451cb5a1d26f4eb5bac5331bd6" name="a71294fb18b2f091cb4db120c47248cb4aaf13c1451cb5a1d26f4eb5bac5331bd6"></a>SF_MZ_FREAD_ERROR&#160;</td><td class="fieldinit">4&#160;</td><td class="fielddoc"><p>Failed to read the first two bytes (MZ signature) of the file. </p>
<p>Failed to read MZ bytes for validation. </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4a3517b65ae973d0d3c3e9f2dabffe3923" name="a71294fb18b2f091cb4db120c47248cb4a3517b65ae973d0d3c3e9f2dabffe3923"></a>SF_NOT_PE&#160;</td><td class="fieldinit">5&#160;</td><td class="fielddoc"><p>The file is not a PE file, hence it is safe. </p>
<p>The file is not a PE (Portable Executable) file. </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4add83add67dcd7ba7c6c8398b2259bc6c" name="a71294fb18b2f091cb4db120c47248cb4add83add67dcd7ba7c6c8398b2259bc6c"></a>SF_CFS_NULL_PATH_POINTER&#160;</td><td class="fieldinit">6&#160;</td><td class="fielddoc"><p>The file path argument in the CFS function is NULL. </p>
<p>NULL file path in Calculate File Size (CFS). </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4a2a9d23d17b854dd73a2d3a78ac46fbb0" name="a71294fb18b2f091cb4db120c47248cb4a2a9d23d17b854dd73a2d3a78ac46fbb0"></a>SF_CFS_NULL_FILE_SIZE_POINTER&#160;</td><td class="fieldinit">7&#160;</td><td class="fielddoc"><p>The file size pointer argument in the CFS function is NULL. </p>
<p>NULL file size pointer in CFS. </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4a27175d186bd0cc8ef253f55c3c5a6e22" name="a71294fb18b2f091cb4db120c47248cb4a27175d186bd0cc8ef253f55c3c5a6e22"></a>SF_CFS_FILE_FOPEN_ERROR&#160;</td><td class="fieldinit">8&#160;</td><td class="fielddoc"><p>The file could not be opened in the CFS function. </p>
<p>Failed to open the file in CFS. </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4a9b337b7034141e114453e51d431de3cd" name="a71294fb18b2f091cb4db120c47248cb4a9b337b7034141e114453e51d431de3cd"></a>SF_CFS_END_FSEEK_ERROR&#160;</td><td class="fieldinit">9&#160;</td><td class="fielddoc"><p>Failed to set file position to the end of the file in the CFS function. </p>
<p>Failed to set file position to end using fseek in CFS. </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4a8be7baf87fa305815af016e51a32e444" name="a71294fb18b2f091cb4db120c47248cb4a8be7baf87fa305815af016e51a32e444"></a>SF_CFS_SIZE_FTELL_ERROR&#160;</td><td class="fieldinit">10&#160;</td><td class="fielddoc"><p>Failed to get the file position using ftell in the CFS function. </p>
<p>Failed to get file position using ftell in CFS. </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4af3946e9f0e9ce7b8afc78d5e15b21bc0" name="a71294fb18b2f091cb4db120c47248cb4af3946e9f0e9ce7b8afc78d5e15b21bc0"></a>SF_CFS_FILE_FCLOSE_ERROR&#160;</td><td class="fieldinit">11&#160;</td><td class="fielddoc"><p>The file could not be closed properly in the CFS function. </p>
<p>Failed to close file in CFS. </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4a77690c5eb7fc8973edd3f2a3a048d9ad" name="a71294fb18b2f091cb4db120c47248cb4a77690c5eb7fc8973edd3f2a3a048d9ad"></a>SF_SMALL_FILE_SIZE&#160;</td><td class="fieldinit">12&#160;</td><td class="fielddoc"><p>The signature length exceeds the file size, indicating a safe file. </p>
<p>Signature length exceeds the file size. File is safe. </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4a9652d75e01f85a8c943d1306e9ff2482" name="a71294fb18b2f091cb4db120c47248cb4a9652d75e01f85a8c943d1306e9ff2482"></a>SF_OFFSET_FSEEK_ERROR&#160;</td><td class="fieldinit">13&#160;</td><td class="fielddoc"><p>Failed to set the file position to the given offset. </p>
<p>Failed to set position on the specified offset. </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4af45f699f07fb92dd03463c708b9286ea" name="a71294fb18b2f091cb4db120c47248cb4af45f699f07fb92dd03463c708b9286ea"></a>SF_BUFFER_FREAD_ERROR&#160;</td><td class="fieldinit">14&#160;</td><td class="fielddoc"><p>Failed to read the signature from the file buffer. </p>
<p>Failed to read the file buffer during scanning. </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4a2a4b00c4f9b7804235df9c4a6218a547" name="a71294fb18b2f091cb4db120c47248cb4a2a4b00c4f9b7804235df9c4a6218a547"></a>SF_FILE_FCLOSE_ERROR&#160;</td><td class="fieldinit">15&#160;</td><td class="fielddoc"><p>The file could not be closed properly during scanning. </p>
<p>Failed to close the file during scan. </p>
</td></tr>
<tr><td class="fieldname"><a id="a71294fb18b2f091cb4db120c47248cb4ac5ea9da038bf21167935fe4dd4004853" name="a71294fb18b2f091cb4db120c47248cb4ac5ea9da038bf21167935fe4dd4004853"></a>SF_VIRUS_DETECTED&#160;</td><td class="fieldinit">16&#160;</td><td class="fielddoc"><p>A virus was detected in the file (signature matched). </p>
<p>A virus was found (signature matches). </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d4/de8/a00061_source.html#l00148">148</a> of file <a class="el" href="../../d4/de8/a00061_source.html">код/kursa/antivirus.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  149</span>{</div>
<div class="line"><span class="lineno">  151</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4ae8c7a0c90e729ec8abeb076a020a549e">SF_SUCCESS</a> = 0, </div>
<div class="line"><span class="lineno">  152</span></div>
<div class="line"><span class="lineno">  154</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a83e9a4b31aea3d4bab1534d67bd8fac1">SF_NULL_FILE_PATH_POINTER</a> = 1, </div>
<div class="line"><span class="lineno">  155</span></div>
<div class="line"><span class="lineno">  157</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a83af1a50193d6dbcda3c5c1d9bdb554d">SF_NULL_VSTRUCT_POINTER</a> = 2, </div>
<div class="line"><span class="lineno">  158</span></div>
<div class="line"><span class="lineno">  160</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a5f412aaaa3f73e6ab637f802ee3c70dc">SF_FILE_FOPEN_ERROR</a> = 3, </div>
<div class="line"><span class="lineno">  161</span></div>
<div class="line"><span class="lineno">  163</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4aaf13c1451cb5a1d26f4eb5bac5331bd6">SF_MZ_FREAD_ERROR</a> = 4, </div>
<div class="line"><span class="lineno">  164</span></div>
<div class="line"><span class="lineno">  166</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a3517b65ae973d0d3c3e9f2dabffe3923">SF_NOT_PE</a> = 5, </div>
<div class="line"><span class="lineno">  167</span></div>
<div class="line"><span class="lineno">  169</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4add83add67dcd7ba7c6c8398b2259bc6c">SF_CFS_NULL_PATH_POINTER</a> = 6, </div>
<div class="line"><span class="lineno">  170</span></div>
<div class="line"><span class="lineno">  172</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a2a9d23d17b854dd73a2d3a78ac46fbb0">SF_CFS_NULL_FILE_SIZE_POINTER</a> = 7, </div>
<div class="line"><span class="lineno">  173</span></div>
<div class="line"><span class="lineno">  175</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a27175d186bd0cc8ef253f55c3c5a6e22">SF_CFS_FILE_FOPEN_ERROR</a> = 8, </div>
<div class="line"><span class="lineno">  176</span></div>
<div class="line"><span class="lineno">  178</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a9b337b7034141e114453e51d431de3cd">SF_CFS_END_FSEEK_ERROR</a> = 9, </div>
<div class="line"><span class="lineno">  179</span></div>
<div class="line"><span class="lineno">  181</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a8be7baf87fa305815af016e51a32e444">SF_CFS_SIZE_FTELL_ERROR</a> = 10, </div>
<div class="line"><span class="lineno">  182</span></div>
<div class="line"><span class="lineno">  184</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4af3946e9f0e9ce7b8afc78d5e15b21bc0">SF_CFS_FILE_FCLOSE_ERROR</a> = 11, </div>
<div class="line"><span class="lineno">  185</span></div>
<div class="line"><span class="lineno">  187</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a77690c5eb7fc8973edd3f2a3a048d9ad">SF_SMALL_FILE_SIZE</a> = 12, </div>
<div class="line"><span class="lineno">  188</span></div>
<div class="line"><span class="lineno">  190</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a9652d75e01f85a8c943d1306e9ff2482">SF_OFFSET_FSEEK_ERROR</a> = 13, </div>
<div class="line"><span class="lineno">  191</span></div>
<div class="line"><span class="lineno">  193</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4af45f699f07fb92dd03463c708b9286ea">SF_BUFFER_FREAD_ERROR</a> = 14, </div>
<div class="line"><span class="lineno">  194</span></div>
<div class="line"><span class="lineno">  196</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a2a4b00c4f9b7804235df9c4a6218a547">SF_FILE_FCLOSE_ERROR</a> = 15, </div>
<div class="line"><span class="lineno">  197</span></div>
<div class="line"><span class="lineno">  199</span>    <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4ac5ea9da038bf21167935fe4dd4004853">SF_VIRUS_DETECTED</a> = 16 </div>
<div class="line"><span class="lineno">  200</span>};</div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4a27175d186bd0cc8ef253f55c3c5a6e22"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4a27175d186bd0cc8ef253f55c3c5a6e22">SF_CFS_FILE_FOPEN_ERROR</a></div><div class="ttdeci">@ SF_CFS_FILE_FOPEN_ERROR</div><div class="ttdoc">The file could not be opened in the CFS function.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00175">код/kursa/antivirus.c:175</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4a2a4b00c4f9b7804235df9c4a6218a547"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4a2a4b00c4f9b7804235df9c4a6218a547">SF_FILE_FCLOSE_ERROR</a></div><div class="ttdeci">@ SF_FILE_FCLOSE_ERROR</div><div class="ttdoc">The file could not be closed properly during scanning.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00196">код/kursa/antivirus.c:196</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4a2a9d23d17b854dd73a2d3a78ac46fbb0"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4a2a9d23d17b854dd73a2d3a78ac46fbb0">SF_CFS_NULL_FILE_SIZE_POINTER</a></div><div class="ttdeci">@ SF_CFS_NULL_FILE_SIZE_POINTER</div><div class="ttdoc">The file size pointer argument in the CFS function is NULL.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00172">код/kursa/antivirus.c:172</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4a3517b65ae973d0d3c3e9f2dabffe3923"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4a3517b65ae973d0d3c3e9f2dabffe3923">SF_NOT_PE</a></div><div class="ttdeci">@ SF_NOT_PE</div><div class="ttdoc">The file is not a PE file, hence it is safe.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00166">код/kursa/antivirus.c:166</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4a5f412aaaa3f73e6ab637f802ee3c70dc"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4a5f412aaaa3f73e6ab637f802ee3c70dc">SF_FILE_FOPEN_ERROR</a></div><div class="ttdeci">@ SF_FILE_FOPEN_ERROR</div><div class="ttdoc">The file could not be opened.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00160">код/kursa/antivirus.c:160</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4a77690c5eb7fc8973edd3f2a3a048d9ad"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4a77690c5eb7fc8973edd3f2a3a048d9ad">SF_SMALL_FILE_SIZE</a></div><div class="ttdeci">@ SF_SMALL_FILE_SIZE</div><div class="ttdoc">The signature length exceeds the file size, indicating a safe file.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00187">код/kursa/antivirus.c:187</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4a83af1a50193d6dbcda3c5c1d9bdb554d"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4a83af1a50193d6dbcda3c5c1d9bdb554d">SF_NULL_VSTRUCT_POINTER</a></div><div class="ttdeci">@ SF_NULL_VSTRUCT_POINTER</div><div class="ttdoc">The virus structure pointer is NULL.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00157">код/kursa/antivirus.c:157</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4a83e9a4b31aea3d4bab1534d67bd8fac1"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4a83e9a4b31aea3d4bab1534d67bd8fac1">SF_NULL_FILE_PATH_POINTER</a></div><div class="ttdeci">@ SF_NULL_FILE_PATH_POINTER</div><div class="ttdoc">The file path argument is NULL.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00154">код/kursa/antivirus.c:154</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4a8be7baf87fa305815af016e51a32e444"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4a8be7baf87fa305815af016e51a32e444">SF_CFS_SIZE_FTELL_ERROR</a></div><div class="ttdeci">@ SF_CFS_SIZE_FTELL_ERROR</div><div class="ttdoc">Failed to get the file position using ftell in the CFS function.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00181">код/kursa/antivirus.c:181</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4a9652d75e01f85a8c943d1306e9ff2482"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4a9652d75e01f85a8c943d1306e9ff2482">SF_OFFSET_FSEEK_ERROR</a></div><div class="ttdeci">@ SF_OFFSET_FSEEK_ERROR</div><div class="ttdoc">Failed to set the file position to the given offset.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00190">код/kursa/antivirus.c:190</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4a9b337b7034141e114453e51d431de3cd"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4a9b337b7034141e114453e51d431de3cd">SF_CFS_END_FSEEK_ERROR</a></div><div class="ttdeci">@ SF_CFS_END_FSEEK_ERROR</div><div class="ttdoc">Failed to set file position to the end of the file in the CFS function.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00178">код/kursa/antivirus.c:178</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4aaf13c1451cb5a1d26f4eb5bac5331bd6"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4aaf13c1451cb5a1d26f4eb5bac5331bd6">SF_MZ_FREAD_ERROR</a></div><div class="ttdeci">@ SF_MZ_FREAD_ERROR</div><div class="ttdoc">Failed to read the first two bytes (MZ signature) of the file.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00163">код/kursa/antivirus.c:163</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4ac5ea9da038bf21167935fe4dd4004853"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4ac5ea9da038bf21167935fe4dd4004853">SF_VIRUS_DETECTED</a></div><div class="ttdeci">@ SF_VIRUS_DETECTED</div><div class="ttdoc">A virus was detected in the file (signature matched).</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00199">код/kursa/antivirus.c:199</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4add83add67dcd7ba7c6c8398b2259bc6c"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4add83add67dcd7ba7c6c8398b2259bc6c">SF_CFS_NULL_PATH_POINTER</a></div><div class="ttdeci">@ SF_CFS_NULL_PATH_POINTER</div><div class="ttdoc">The file path argument in the CFS function is NULL.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00169">код/kursa/antivirus.c:169</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4ae8c7a0c90e729ec8abeb076a020a549e"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4ae8c7a0c90e729ec8abeb076a020a549e">SF_SUCCESS</a></div><div class="ttdeci">@ SF_SUCCESS</div><div class="ttdoc">The file scan was successful, no issues encountered.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00151">код/kursa/antivirus.c:151</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4af3946e9f0e9ce7b8afc78d5e15b21bc0"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4af3946e9f0e9ce7b8afc78d5e15b21bc0">SF_CFS_FILE_FCLOSE_ERROR</a></div><div class="ttdeci">@ SF_CFS_FILE_FCLOSE_ERROR</div><div class="ttdoc">The file could not be closed properly in the CFS function.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00184">код/kursa/antivirus.c:184</a></div></div>
<div class="ttc" id="aa00061_html_a71294fb18b2f091cb4db120c47248cb4af45f699f07fb92dd03463c708b9286ea"><div class="ttname"><a href="#a71294fb18b2f091cb4db120c47248cb4af45f699f07fb92dd03463c708b9286ea">SF_BUFFER_FREAD_ERROR</a></div><div class="ttdeci">@ SF_BUFFER_FREAD_ERROR</div><div class="ttdoc">Failed to read the signature from the file buffer.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00193">код/kursa/antivirus.c:193</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac151026d2ff41253cf6e6c247eab91b1" name="ac151026d2ff41253cf6e6c247eab91b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac151026d2ff41253cf6e6c247eab91b1">&#9670;&#160;</a></span>calculate_file_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calculate_file_size </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>file_path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>file_size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the size of a file. </p>
<p>This function determines the total number of bytes in the file specified by the given path and stores the result in a provided variable.</p>
<p>Example usage: </p><div class="fragment"><div class="line"><span class="keywordtype">size_t</span> file_size = 0;</div>
<div class="line"><span class="keywordtype">int</span> result = <a class="code hl_function" href="#ac151026d2ff41253cf6e6c247eab91b1">calculate_file_size</a>(<span class="stringliteral">&quot;target.exe&quot;</span>, &amp;file_size);</div>
<div class="line"><span class="keywordflow">if</span> (result == <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1ad622e94493a882562592bbe767353b71">CFS_SUCCESS</a>)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;File size: %zu bytes\n&quot;</span>, file_size);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error calculating file size: %d\n&quot;</span>, result);</div>
<div class="line">}</div>
<div class="ttc" id="aa00061_html_ac151026d2ff41253cf6e6c247eab91b1"><div class="ttname"><a href="#ac151026d2ff41253cf6e6c247eab91b1">calculate_file_size</a></div><div class="ttdeci">int calculate_file_size(const char *file_path, size_t *file_size)</div><div class="ttdoc">Calculates the size of a file.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00648">код/kursa/antivirus.c:648</a></div></div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file_path</td><td>Path to the file. </td></tr>
    <tr><td class="paramname">file_size</td><td>Pointer to a variable to store the resulting file size. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code from <a class="el" href="#a6d150856ebcbc39802d95e25f1330df1">Error_Codes_CFS</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/de8/a00061_source.html#l00648">648</a> of file <a class="el" href="../../d4/de8/a00061_source.html">код/kursa/antivirus.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  649</span>{</div>
<div class="line"><span class="lineno">  650</span>    <span class="keywordflow">if</span> (file_path == NULL)</div>
<div class="line"><span class="lineno">  651</span>    {</div>
<div class="line"><span class="lineno">  652</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1a6d718b6f23a18eaefa43664ee3dc763d">CFS_NULL_FILE_PATH_POINTER</a>; <span class="comment">// 1</span></div>
<div class="line"><span class="lineno">  653</span>    }</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>    <span class="keywordflow">if</span> (file_size == NULL)</div>
<div class="line"><span class="lineno">  656</span>    {</div>
<div class="line"><span class="lineno">  657</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1a8b09752e65b1530123e2460d6536492d">CFS_NULL_FILE_SIZE_POINTER</a>; <span class="comment">// 2</span></div>
<div class="line"><span class="lineno">  658</span>    }</div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>    <span class="comment">// Declare all the variables:</span></div>
<div class="line"><span class="lineno">  661</span>    <span class="keywordtype">long</span> size;</div>
<div class="line"><span class="lineno">  662</span>    FILE *file = fopen(file_path, <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>    <span class="keywordflow">if</span> (file == NULL)</div>
<div class="line"><span class="lineno">  665</span>    {</div>
<div class="line"><span class="lineno">  666</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1a1f73fee4befb453fa5534f53c04a6d5b">CFS_FILE_FOPEN_ERROR</a>; <span class="comment">// 3</span></div>
<div class="line"><span class="lineno">  667</span>    }</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>    <span class="keywordflow">if</span> (fseek(file, 0, SEEK_END) != 0)</div>
<div class="line"><span class="lineno">  670</span>    {</div>
<div class="line"><span class="lineno">  671</span>        fclose(file);</div>
<div class="line"><span class="lineno">  672</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1ad5c83b632548a90f3febe7168cc29e7d">CFS_END_FSEEK_ERROR</a>; <span class="comment">// 4</span></div>
<div class="line"><span class="lineno">  673</span>    }</div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span>    size = ftell(file);</div>
<div class="line"><span class="lineno">  676</span> </div>
<div class="line"><span class="lineno">  677</span>    <span class="keywordflow">if</span> (size == -1)</div>
<div class="line"><span class="lineno">  678</span>    {</div>
<div class="line"><span class="lineno">  679</span>        fclose(file);</div>
<div class="line"><span class="lineno">  680</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1aab1185a29decc2242b01e17afb12e435">CFS_SIZE_FTELL_ERROR</a>; <span class="comment">// 5</span></div>
<div class="line"><span class="lineno">  681</span>    }</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>    *file_size = size;</div>
<div class="line"><span class="lineno">  684</span> </div>
<div class="line"><span class="lineno">  685</span>    <span class="keywordflow">if</span> (fclose(file) != 0)</div>
<div class="line"><span class="lineno">  686</span>    {</div>
<div class="line"><span class="lineno">  687</span>        fclose(file);</div>
<div class="line"><span class="lineno">  688</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1aafb51e061b61c1f662dc5c3dddf19366">CFS_FILE_FCLOSE_ERROR</a>; <span class="comment">// 6</span></div>
<div class="line"><span class="lineno">  689</span>    }</div>
<div class="line"><span class="lineno">  690</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1ad622e94493a882562592bbe767353b71">CFS_SUCCESS</a>; <span class="comment">// 0</span></div>
<div class="line"><span class="lineno">  691</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/de8/a00061_source.html#l00124">CFS_END_FSEEK_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00130">CFS_FILE_FCLOSE_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00121">CFS_FILE_FOPEN_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00115">CFS_NULL_FILE_PATH_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00118">CFS_NULL_FILE_SIZE_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00127">CFS_SIZE_FTELL_ERROR</a>, and <a class="el" href="../../d4/de8/a00061_source.html#l00112">CFS_SUCCESS</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/de8/a00061_source.html#l00734">scan_file()</a>.</p>

</div>
</div>
<a id="ae66f6b31b5ad750f1fe042a706a4e3d4" name="ae66f6b31b5ad750f1fe042a706a4e3d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66f6b31b5ad750f1fe042a706a4e3d4">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Entry point of the antivirus scanner. </p>
<p>Prompts user for paths to the signature and target file. Reports whether a virus is found based on the provided signature.</p>
<dl class="section return"><dt>Returns</dt><dd>Error code from <a class="el" href="#a505d9c7125a411e66685d2227d5876ca">Error_Codes_Main</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/de8/a00061_source.html#l00269">269</a> of file <a class="el" href="../../d4/de8/a00061_source.html">код/kursa/antivirus.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  270</span>{</div>
<div class="line"><span class="lineno">  271</span>    <span class="comment">// Declare all the variables:</span></div>
<div class="line"><span class="lineno">  272</span>    <a class="code hl_struct" href="../../d7/d46/a00002.html#d0/dc0/a00033">VirusSignature</a> vs;</div>
<div class="line"><span class="lineno">  273</span>    <span class="keywordtype">char</span> sign_path[<a class="code hl_define" href="#a58d1d45bf875bddd6dc4dadb13e11d7f">MAX_FILE_SYSTEM_ADRESS_SIZE</a>];</div>
<div class="line"><span class="lineno">  274</span>    <span class="keywordtype">char</span> target_path[<a class="code hl_define" href="#a58d1d45bf875bddd6dc4dadb13e11d7f">MAX_FILE_SYSTEM_ADRESS_SIZE</a>];</div>
<div class="line"><span class="lineno">  275</span>    <span class="keywordtype">int</span> result;</div>
<div class="line"><span class="lineno">  276</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *message;</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>    message = <span class="stringliteral">&quot;Welcome to the virus scanner program!\n\n&quot;</span></div>
<div class="line"><span class="lineno">  279</span>              <span class="stringliteral">&quot;This program scans files on your computer to check for viruses.\n&quot;</span></div>
<div class="line"><span class="lineno">  280</span>              <span class="stringliteral">&quot;Viruses have unique \&quot;signatures\&quot; - special sequences of numbers that the program can recognize.\n&quot;</span></div>
<div class="line"><span class="lineno">  281</span>              <span class="stringliteral">&quot;The program will search for these virus signatures in the file you select.\n&quot;</span></div>
<div class="line"><span class="lineno">  282</span>              <span class="stringliteral">&quot;If it finds a virus, it will alert you.\n&quot;</span></div>
<div class="line"><span class="lineno">  283</span>              <span class="stringliteral">&quot;If no viruses are found, the program will tell you the file is clean.\n&quot;</span></div>
<div class="line"><span class="lineno">  284</span>              <span class="stringliteral">&quot;Note: The program only supports file names/paths that consist\n&quot;</span></div>
<div class="line"><span class="lineno">  285</span>              <span class="stringliteral">&quot;solely of Latin alphabet letters. Any other characters will result in a file reading error.\n\n&quot;</span></div>
<div class="line"><span class="lineno">  286</span>              <span class="stringliteral">&quot;Enter path to signature file: \n&quot;</span></div>
<div class="line"><span class="lineno">  287</span>              <span class="stringliteral">&quot;Example: signature.txt or D:\\Bin1\\Bin2\\signature.txt\n&quot;</span>;</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    <span class="keywordflow">if</span> (printf(<span class="stringliteral">&quot;%s&quot;</span>,message) &lt; 0)</div>
<div class="line"><span class="lineno">  291</span>    {</div>
<div class="line"><span class="lineno">  292</span>        perror(<span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  293</span>               <span class="stringliteral">&quot;int printf(const char *restrict format, ...);\n&quot;</span></div>
<div class="line"><span class="lineno">  294</span>               <span class="stringliteral">&quot;Desciption: Failed to output message\n&quot;</span>);</div>
<div class="line"><span class="lineno">  295</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa0dcb1ae4354f95e2960f9c1542ebd456">MAIN_SIGN_PRINTF_ERROR</a>; <span class="comment">// 1</span></div>
<div class="line"><span class="lineno">  296</span>    }</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>    <span class="keywordflow">if</span> (scanf(<span class="stringliteral">&quot;%s&quot;</span>,sign_path) != 1)</div>
<div class="line"><span class="lineno">  299</span>    {</div>
<div class="line"><span class="lineno">  300</span>        perror(<span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  301</span>               <span class="stringliteral">&quot;int scanf(const char *restrict format, ...);\n&quot;</span></div>
<div class="line"><span class="lineno">  302</span>               <span class="stringliteral">&quot;Desciption: Failed to reading signature file path\n&quot;</span>);</div>
<div class="line"><span class="lineno">  303</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa173c9137cec343584f6ba48d2ec66852">MAIN_SIGN_SCANF_ERROR</a>; <span class="comment">// 2</span></div>
<div class="line"><span class="lineno">  304</span>    }</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>    result = <a class="code hl_function" href="#a8e3328c6c60e31ff127ca888d472fb0c">read_signature</a>(sign_path, &amp;vs);</div>
<div class="line"><span class="lineno">  307</span>    <span class="keywordflow">if</span> (result != <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487cadb1dd6134c0f933bc9659935942d908f">RS_SUCCESS</a>) <span class="comment">// result != 0</span></div>
<div class="line"><span class="lineno">  308</span>    {</div>
<div class="line"><span class="lineno">  309</span>        <span class="keywordflow">switch</span>(result)</div>
<div class="line"><span class="lineno">  310</span>        {</div>
<div class="line"><span class="lineno">  311</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487cad5c1ee2dcd3eced7b598f0f7eddde9ce">RS_NULL_FILE_PATH_POINTER</a>: <span class="comment">// case 1</span></div>
<div class="line"><span class="lineno">  312</span>            {</div>
<div class="line"><span class="lineno">  313</span>                message = <span class="stringliteral">&quot;Error in variable:\n&quot;</span></div>
<div class="line"><span class="lineno">  314</span>                           <span class="stringliteral">&quot;const char *file_path;\n&quot;</span></div>
<div class="line"><span class="lineno">  315</span>                           <span class="stringliteral">&quot;Description: Signature file path pointer is NULL\n&quot;</span>;</div>
<div class="line"><span class="lineno">  316</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  317</span>            }</div>
<div class="line"><span class="lineno">  318</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487ca22802c47292e70b0a339ff994b7907c9">RS_NULL_VSTRUCT_POINTER</a>: <span class="comment">// case 2</span></div>
<div class="line"><span class="lineno">  319</span>                {</div>
<div class="line"><span class="lineno">  320</span>                    message = <span class="stringliteral">&quot;Error in variable:\n&quot;</span></div>
<div class="line"><span class="lineno">  321</span>                               <span class="stringliteral">&quot;VirusSignature *vs;\n&quot;</span></div>
<div class="line"><span class="lineno">  322</span>                               <span class="stringliteral">&quot;Description: Virus structure pointer is NULL\n&quot;</span>;</div>
<div class="line"><span class="lineno">  323</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  324</span>                }</div>
<div class="line"><span class="lineno">  325</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487ca72f057ce83550944e650aaac64734965">RS_FILE_FOPEN_ERROR</a>: <span class="comment">// case 3</span></div>
<div class="line"><span class="lineno">  326</span>                {</div>
<div class="line"><span class="lineno">  327</span>                    message = <span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  328</span>                               <span class="stringliteral">&quot;FILE *fopen(const char *restrict pathname, const char *restrict mode);\n&quot;</span></div>
<div class="line"><span class="lineno">  329</span>                               <span class="stringliteral">&quot;Description: Failed to open signature file\n&quot;</span>;</div>
<div class="line"><span class="lineno">  330</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  331</span>                }</div>
<div class="line"><span class="lineno">  332</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487ca4e716b355dce153ee5b2ff3fd2bfccd1">RS_SIGNATURE_FSCANF_ERROR</a>: <span class="comment">// case 4</span></div>
<div class="line"><span class="lineno">  333</span>                {</div>
<div class="line"><span class="lineno">  334</span>                    message = <span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  335</span>                               <span class="stringliteral">&quot;int fscanf(FILE *restrict stream, const char *restrict format, ...);\n&quot;</span></div>
<div class="line"><span class="lineno">  336</span>                               <span class="stringliteral">&quot;Description: Failed to read signature from file\n&quot;</span>;</div>
<div class="line"><span class="lineno">  337</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  338</span>                }</div>
<div class="line"><span class="lineno">  339</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487cae61710028a61c4d375b610bf6d821469">RS_OFFSET_FSCANF_ERROR</a>: <span class="comment">// case 5</span></div>
<div class="line"><span class="lineno">  340</span>                {</div>
<div class="line"><span class="lineno">  341</span>                    message = <span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  342</span>                               <span class="stringliteral">&quot;int fscanf(FILE *restrict stream, const char *restrict format, ...);\n&quot;</span></div>
<div class="line"><span class="lineno">  343</span>                               <span class="stringliteral">&quot;Description: Failed to read offset from file\n&quot;</span>;</div>
<div class="line"><span class="lineno">  344</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  345</span>                }</div>
<div class="line"><span class="lineno">  346</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487ca5bab52062e9e8a25d41337700a267d51">RS_VNAME_FSCANF_ERROR</a>: <span class="comment">// case 6</span></div>
<div class="line"><span class="lineno">  347</span>                {</div>
<div class="line"><span class="lineno">  348</span>                    message = <span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  349</span>                               <span class="stringliteral">&quot;int fscanf(FILE *restrict stream, const char *restrict format, ...);\n&quot;</span></div>
<div class="line"><span class="lineno">  350</span>                               <span class="stringliteral">&quot;Description: Failed to read virus name from file\n&quot;</span>;</div>
<div class="line"><span class="lineno">  351</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  352</span>                }</div>
<div class="line"><span class="lineno">  353</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487ca0cda8a27dadca17b568a928144060c83">RS_FILE_FCLOSE_ERROR</a>: <span class="comment">// case 7</span></div>
<div class="line"><span class="lineno">  354</span>                {</div>
<div class="line"><span class="lineno">  355</span>                    message = <span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  356</span>                               <span class="stringliteral">&quot;int fclose(FILE *stream);\n&quot;</span></div>
<div class="line"><span class="lineno">  357</span>                               <span class="stringliteral">&quot;Description: Failed to close signature file\n&quot;</span>;</div>
<div class="line"><span class="lineno">  358</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  359</span>                }</div>
<div class="line"><span class="lineno">  360</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  361</span>                {</div>
<div class="line"><span class="lineno">  362</span>                message = <span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  363</span>                           <span class="stringliteral">&quot;int read_signature(const char *file_path, VirusSignature *vs)\n&quot;</span></div>
<div class="line"><span class="lineno">  364</span>                           <span class="stringliteral">&quot;Description: Unknown error occurred while reading signature\n&quot;</span>;</div>
<div class="line"><span class="lineno">  365</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  366</span>                }</div>
<div class="line"><span class="lineno">  367</span>        }</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>        <span class="keywordflow">if</span> (printf(<span class="stringliteral">&quot;%s&quot;</span>, message) &lt; 0)</div>
<div class="line"><span class="lineno">  370</span>        {</div>
<div class="line"><span class="lineno">  371</span>            perror(<span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  372</span>                   <span class="stringliteral">&quot;int printf(const char *restrict format, ...);\n&quot;</span></div>
<div class="line"><span class="lineno">  373</span>                   <span class="stringliteral">&quot;Desciption: Failed to output message\n&quot;</span>);</div>
<div class="line"><span class="lineno">  374</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa4a417dbf7867f1696c6525c2c4b70fd5">MAIN_RS_PRINTF_ERROR</a>; <span class="comment">// 3</span></div>
<div class="line"><span class="lineno">  375</span>        }</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa9dcdf42d9372703b2f2498b37a195dcc">MAIN_RS_ERROR</a>; <span class="comment">// 4</span></div>
<div class="line"><span class="lineno">  378</span>    }</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>    message = <span class="stringliteral">&quot;\nEnter path to target file: \n&quot;</span></div>
<div class="line"><span class="lineno">  381</span>              <span class="stringliteral">&quot;Example: target.exe OR C:\\Bin1\\Bin2\\target.exe\n&quot;</span>;</div>
<div class="line"><span class="lineno">  382</span>    <span class="keywordflow">if</span> (printf(<span class="stringliteral">&quot;%s&quot;</span>, message) &lt; 0)</div>
<div class="line"><span class="lineno">  383</span>    {</div>
<div class="line"><span class="lineno">  384</span>       perror(<span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  385</span>              <span class="stringliteral">&quot;int printf(const char *restrict format, ...);\n&quot;</span></div>
<div class="line"><span class="lineno">  386</span>              <span class="stringliteral">&quot;Description: Failed to output message\n&quot;</span>);</div>
<div class="line"><span class="lineno">  387</span>       <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa051f810ad358e76497c40065780a1939">MAIN_TARG_PRINTF_ERROR</a>; <span class="comment">// 5</span></div>
<div class="line"><span class="lineno">  388</span>    }</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>    <span class="keywordflow">if</span> (scanf(<span class="stringliteral">&quot;%s&quot;</span>,target_path) != 1)</div>
<div class="line"><span class="lineno">  391</span>    {</div>
<div class="line"><span class="lineno">  392</span>        perror(<span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  393</span>               <span class="stringliteral">&quot;int scanf(const char *restrict format, ...);\n&quot;</span></div>
<div class="line"><span class="lineno">  394</span>               <span class="stringliteral">&quot;Description: Failed to reading signature file path\n&quot;</span>);</div>
<div class="line"><span class="lineno">  395</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caaa979183865601e1617961c53893b772a">MAIN_TARG_SCANF_ERROR</a>; <span class="comment">// 6</span></div>
<div class="line"><span class="lineno">  396</span>    }</div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span>    result = <a class="code hl_function" href="#aa89d5cbcf8384ad01bd00a74da7d7d5f">scan_file</a>(target_path, &amp;vs);</div>
<div class="line"><span class="lineno">  399</span>    <span class="keywordflow">if</span> ((result == <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4ae8c7a0c90e729ec8abeb076a020a549e">SF_SUCCESS</a>) || <span class="comment">// if result == 0 ||</span></div>
<div class="line"><span class="lineno">  400</span>       (result == <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a3517b65ae973d0d3c3e9f2dabffe3923">SF_NOT_PE</a>) || <span class="comment">//  result == 5 ||</span></div>
<div class="line"><span class="lineno">  401</span>       (result == <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a77690c5eb7fc8973edd3f2a3a048d9ad">SF_SMALL_FILE_SIZE</a>)) <span class="comment">// result == 12</span></div>
<div class="line"><span class="lineno">  402</span>    {</div>
<div class="line"><span class="lineno">  403</span>        <span class="keywordflow">if</span> (printf(<span class="stringliteral">&quot;\nAll OK, FILE(%s) is safe&quot;</span>, target_path) &lt; 0)</div>
<div class="line"><span class="lineno">  404</span>        {</div>
<div class="line"><span class="lineno">  405</span>            perror(<span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  406</span>                   <span class="stringliteral">&quot;int printf(const char *restrict format, ...);\n&quot;</span></div>
<div class="line"><span class="lineno">  407</span>                   <span class="stringliteral">&quot;Description: Failed to output message\n&quot;</span>);</div>
<div class="line"><span class="lineno">  408</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa26eec8f2fb6c008f4d5faf977ea90c76">MAIN_OK_PRINTF_ERROR</a>; <span class="comment">// 7</span></div>
<div class="line"><span class="lineno">  409</span>        }</div>
<div class="line"><span class="lineno">  410</span>    }</div>
<div class="line"><span class="lineno">  411</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (result == <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4ac5ea9da038bf21167935fe4dd4004853">SF_VIRUS_DETECTED</a>) <span class="comment">// if (result == 16)</span></div>
<div class="line"><span class="lineno">  412</span>    {</div>
<div class="line"><span class="lineno">  413</span>        <span class="keywordflow">if</span> (printf(<span class="stringliteral">&quot;\nFind VIRUS(%s) in FILE(%s)&quot;</span>, vs.<a class="code hl_variable" href="../../d7/d46/a00002.html#abafda29c1fbbe5c07c36dcecb5d1a4d6">virus_name</a>, target_path) &lt; 0)</div>
<div class="line"><span class="lineno">  414</span>        {</div>
<div class="line"><span class="lineno">  415</span>            perror(<span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  416</span>                   <span class="stringliteral">&quot;int printf(const char *restrict format, ...);\n&quot;</span></div>
<div class="line"><span class="lineno">  417</span>                   <span class="stringliteral">&quot;Description: Failed to output message\n&quot;</span>);</div>
<div class="line"><span class="lineno">  418</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caadc4189703cdc6a6d7a5fce15fd79696b">MAIN_VIRUS_PRINTF_ERROR</a>; <span class="comment">// 8</span></div>
<div class="line"><span class="lineno">  419</span>        }</div>
<div class="line"><span class="lineno">  420</span>    }</div>
<div class="line"><span class="lineno">  421</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  422</span>    {</div>
<div class="line"><span class="lineno">  423</span>        <span class="keywordflow">switch</span>(result) <span class="comment">// There are no cases 0, 5, 12, 16 in this switch</span></div>
<div class="line"><span class="lineno">  424</span>                       <span class="comment">// 0 = SF_SUCCESS, 5 = SF_NOT_PE, 12 = SF_SMALL_FILE_SIZE</span></div>
<div class="line"><span class="lineno">  425</span>                       <span class="comment">// 16 = SF_VIRUS_DETECTED</span></div>
<div class="line"><span class="lineno">  426</span>        {</div>
<div class="line"><span class="lineno">  427</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a83e9a4b31aea3d4bab1534d67bd8fac1">SF_NULL_FILE_PATH_POINTER</a>: <span class="comment">// case 1</span></div>
<div class="line"><span class="lineno">  428</span>            {</div>
<div class="line"><span class="lineno">  429</span>                message = <span class="stringliteral">&quot;Error in variable:\n&quot;</span></div>
<div class="line"><span class="lineno">  430</span>                          <span class="stringliteral">&quot;const char *file_path;\n&quot;</span></div>
<div class="line"><span class="lineno">  431</span>                          <span class="stringliteral">&quot;Description: Scan file path pointer is NULL\n&quot;</span>;</div>
<div class="line"><span class="lineno">  432</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  433</span>            }</div>
<div class="line"><span class="lineno">  434</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a83af1a50193d6dbcda3c5c1d9bdb554d">SF_NULL_VSTRUCT_POINTER</a>: <span class="comment">// case 2</span></div>
<div class="line"><span class="lineno">  435</span>            {</div>
<div class="line"><span class="lineno">  436</span>                message = <span class="stringliteral">&quot;Error in variable:\n&quot;</span></div>
<div class="line"><span class="lineno">  437</span>                          <span class="stringliteral">&quot;VirusSignature *vs;\n&quot;</span></div>
<div class="line"><span class="lineno">  438</span>                          <span class="stringliteral">&quot;Description: Virus structure pointer is NULL\n&quot;</span>;</div>
<div class="line"><span class="lineno">  439</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  440</span>            }</div>
<div class="line"><span class="lineno">  441</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a5f412aaaa3f73e6ab637f802ee3c70dc">SF_FILE_FOPEN_ERROR</a>: <span class="comment">// case 3</span></div>
<div class="line"><span class="lineno">  442</span>            {</div>
<div class="line"><span class="lineno">  443</span>                message = <span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  444</span>                          <span class="stringliteral">&quot;FILE *fopen(const char *restrict pathname, const char *restrict mode);\n&quot;</span></div>
<div class="line"><span class="lineno">  445</span>                          <span class="stringliteral">&quot;Description: Failed to open scan file\n&quot;</span>;</div>
<div class="line"><span class="lineno">  446</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  447</span>            }</div>
<div class="line"><span class="lineno">  448</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4aaf13c1451cb5a1d26f4eb5bac5331bd6">SF_MZ_FREAD_ERROR</a>: <span class="comment">// case 4</span></div>
<div class="line"><span class="lineno">  449</span>            {</div>
<div class="line"><span class="lineno">  450</span>                message = <span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  451</span>                          <span class="stringliteral">&quot;size_t fread(void *restrict ptr, size_t size, size_t nitems, FILE *restrict stream);\n&quot;</span></div>
<div class="line"><span class="lineno">  452</span>                          <span class="stringliteral">&quot;Description: Failed to read MZ header from file\n&quot;</span>;</div>
<div class="line"><span class="lineno">  453</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  454</span>            }</div>
<div class="line"><span class="lineno">  455</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4add83add67dcd7ba7c6c8398b2259bc6c">SF_CFS_NULL_PATH_POINTER</a>: <span class="comment">// case 6</span></div>
<div class="line"><span class="lineno">  456</span>            {</div>
<div class="line"><span class="lineno">  457</span>                message = <span class="stringliteral">&quot;Error in variable:\n&quot;</span></div>
<div class="line"><span class="lineno">  458</span>                          <span class="stringliteral">&quot;const char *file path;&quot;</span></div>
<div class="line"><span class="lineno">  459</span>                          <span class="stringliteral">&quot;Description: In function int calculate_file_size(const char *file_path, size_t *file_size) &quot;</span></div>
<div class="line"><span class="lineno">  460</span>                          <span class="stringliteral">&quot;file path pointer is NULL\n&quot;</span>;</div>
<div class="line"><span class="lineno">  461</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  462</span>            }</div>
<div class="line"><span class="lineno">  463</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a2a9d23d17b854dd73a2d3a78ac46fbb0">SF_CFS_NULL_FILE_SIZE_POINTER</a>: <span class="comment">// case 7</span></div>
<div class="line"><span class="lineno">  464</span>            {</div>
<div class="line"><span class="lineno">  465</span>                message = <span class="stringliteral">&quot;Error in variable:\n&quot;</span></div>
<div class="line"><span class="lineno">  466</span>                          <span class="stringliteral">&quot;size_t *file_size;\n&quot;</span></div>
<div class="line"><span class="lineno">  467</span>                          <span class="stringliteral">&quot;Description: In function int calculate_file_size(const char *file_path, size_t *file_size) &quot;</span></div>
<div class="line"><span class="lineno">  468</span>                          <span class="stringliteral">&quot;file size pointer is NULL\n&quot;</span>;</div>
<div class="line"><span class="lineno">  469</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  470</span>            }</div>
<div class="line"><span class="lineno">  471</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a27175d186bd0cc8ef253f55c3c5a6e22">SF_CFS_FILE_FOPEN_ERROR</a>: <span class="comment">// case 8</span></div>
<div class="line"><span class="lineno">  472</span>            {</div>
<div class="line"><span class="lineno">  473</span>                message = <span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  474</span>                          <span class="stringliteral">&quot;FILE *fopen(const char *restrict pathname, const char *restrict mode);\n&quot;</span></div>
<div class="line"><span class="lineno">  475</span>                          <span class="stringliteral">&quot;Description: In function int calculate_file_size(const char *file_path, size_t *file_size) &quot;</span></div>
<div class="line"><span class="lineno">  476</span>                          <span class="stringliteral">&quot;failed to open file for size calculation\n&quot;</span>;</div>
<div class="line"><span class="lineno">  477</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  478</span>            }</div>
<div class="line"><span class="lineno">  479</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a9b337b7034141e114453e51d431de3cd">SF_CFS_END_FSEEK_ERROR</a>: <span class="comment">// case 9</span></div>
<div class="line"><span class="lineno">  480</span>            {</div>
<div class="line"><span class="lineno">  481</span>                message = <span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  482</span>                          <span class="stringliteral">&quot;int fseek(FILE *stream, long offset, int whence);\n&quot;</span></div>
<div class="line"><span class="lineno">  483</span>                          <span class="stringliteral">&quot;Description: In function int calculate_file_size(const char *file_path, size_t *file_size) &quot;</span></div>
<div class="line"><span class="lineno">  484</span>                          <span class="stringliteral">&quot;failed to set offset position in file for size calculation\n&quot;</span>;</div>
<div class="line"><span class="lineno">  485</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  486</span>            }</div>
<div class="line"><span class="lineno">  487</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a8be7baf87fa305815af016e51a32e444">SF_CFS_SIZE_FTELL_ERROR</a>: <span class="comment">// case 10</span></div>
<div class="line"><span class="lineno">  488</span>            {</div>
<div class="line"><span class="lineno">  489</span>                message = <span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  490</span>                          <span class="stringliteral">&quot;long ftell(FILE *stream);\n&quot;</span></div>
<div class="line"><span class="lineno">  491</span>                          <span class="stringliteral">&quot;Description: In function int calculate_file_size(const char *file_path, size_t *file_size) &quot;</span></div>
<div class="line"><span class="lineno">  492</span>                          <span class="stringliteral">&quot;failed to tell file position for size calculation\n&quot;</span>;</div>
<div class="line"><span class="lineno">  493</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  494</span>            }</div>
<div class="line"><span class="lineno">  495</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4af3946e9f0e9ce7b8afc78d5e15b21bc0">SF_CFS_FILE_FCLOSE_ERROR</a>: <span class="comment">// case 11</span></div>
<div class="line"><span class="lineno">  496</span>            {</div>
<div class="line"><span class="lineno">  497</span>                message = <span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  498</span>                          <span class="stringliteral">&quot;int fclose(FILE *stream);\n&quot;</span></div>
<div class="line"><span class="lineno">  499</span>                          <span class="stringliteral">&quot;Description: In function int calculate_file_size(const char *file_path, size_t *file_size) &quot;</span></div>
<div class="line"><span class="lineno">  500</span>                          <span class="stringliteral">&quot;failed to close file after size calculation\n&quot;</span>;</div>
<div class="line"><span class="lineno">  501</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  502</span>            }</div>
<div class="line"><span class="lineno">  503</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a9652d75e01f85a8c943d1306e9ff2482">SF_OFFSET_FSEEK_ERROR</a>: <span class="comment">// case 13</span></div>
<div class="line"><span class="lineno">  504</span>            {</div>
<div class="line"><span class="lineno">  505</span>                message = <span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  506</span>                          <span class="stringliteral">&quot;int fseek(FILE *stream, long offset, int whence);\n&quot;</span></div>
<div class="line"><span class="lineno">  507</span>                          <span class="stringliteral">&quot;Description: Failed to set offset position in file\n&quot;</span>;</div>
<div class="line"><span class="lineno">  508</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  509</span>            }</div>
<div class="line"><span class="lineno">  510</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4af45f699f07fb92dd03463c708b9286ea">SF_BUFFER_FREAD_ERROR</a>: <span class="comment">// case 14</span></div>
<div class="line"><span class="lineno">  511</span>            {</div>
<div class="line"><span class="lineno">  512</span>                message = <span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  513</span>                          <span class="stringliteral">&quot;size_t fread(void *restrict ptr, size_t size, size_t nitems, FILE *restrict stream);\n&quot;</span></div>
<div class="line"><span class="lineno">  514</span>                          <span class="stringliteral">&quot;Description: Failed to read buffer from file\n&quot;</span>;</div>
<div class="line"><span class="lineno">  515</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  516</span>            }</div>
<div class="line"><span class="lineno">  517</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a2a4b00c4f9b7804235df9c4a6218a547">SF_FILE_FCLOSE_ERROR</a>: <span class="comment">// case 15</span></div>
<div class="line"><span class="lineno">  518</span>            {</div>
<div class="line"><span class="lineno">  519</span>                message = <span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  520</span>                          <span class="stringliteral">&quot;int fclose(FILE *stream);\n&quot;</span></div>
<div class="line"><span class="lineno">  521</span>                          <span class="stringliteral">&quot;Description: Failed to close scan file\n&quot;</span>;</div>
<div class="line"><span class="lineno">  522</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  523</span>            }</div>
<div class="line"><span class="lineno">  524</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  525</span>            {</div>
<div class="line"><span class="lineno">  526</span>                message = <span class="stringliteral">&quot;Error in function:&quot;</span></div>
<div class="line"><span class="lineno">  527</span>                          <span class="stringliteral">&quot;int scan_file(const char *file_path, VirusSignature *vs);\n&quot;</span></div>
<div class="line"><span class="lineno">  528</span>                          <span class="stringliteral">&quot;Description: Unknown error occurred while scaninng signature\n&quot;</span>;</div>
<div class="line"><span class="lineno">  529</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  530</span>            }</div>
<div class="line"><span class="lineno">  531</span>        }</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>        <span class="keywordflow">if</span> (printf(<span class="stringliteral">&quot;%s&quot;</span>, message) &lt; 0)</div>
<div class="line"><span class="lineno">  534</span>        {</div>
<div class="line"><span class="lineno">  535</span>            perror(<span class="stringliteral">&quot;Error in function:\n&quot;</span></div>
<div class="line"><span class="lineno">  536</span>                   <span class="stringliteral">&quot;int printf(const char *restrict format, ...);\n&quot;</span></div>
<div class="line"><span class="lineno">  537</span>                   <span class="stringliteral">&quot;Description: Failed to output message\n&quot;</span>);</div>
<div class="line"><span class="lineno">  538</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa2d6d9903a4034508690e48adc0b49be2">MAIN_SF_PRINTF_ERROR</a>; <span class="comment">// 9</span></div>
<div class="line"><span class="lineno">  539</span>        }</div>
<div class="line"><span class="lineno">  540</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caaadcab435f8ce5aa4bda37d3db399bd87">MAIN_SF_ERROR</a>; <span class="comment">// 10</span></div>
<div class="line"><span class="lineno">  541</span>    }</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a505d9c7125a411e66685d2227d5876caa0ac975def3016aa1304a4fd798658c45">MAIN_SUCCESS</a>; <span class="comment">// 0</span></div>
<div class="line"><span class="lineno">  544</span>}</div>
<div class="ttc" id="aa00002_html_abafda29c1fbbe5c07c36dcecb5d1a4d6"><div class="ttname"><a href="../../d7/d46/a00002.html#abafda29c1fbbe5c07c36dcecb5d1a4d6">VirusSignature::virus_name</a></div><div class="ttdeci">char virus_name[256]</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00034">код/kursa/antivirus.c:34</a></div></div>
<div class="ttc" id="aa00002_html_d0/dc0/a00033"><div class="ttname"><a href="../../d7/d46/a00002.html#d0/dc0/a00033">VirusSignature</a></div><div class="ttdoc">Represents a virus signature.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00030">код/kursa/antivirus.c:31</a></div></div>
<div class="ttc" id="aa00061_html_a58d1d45bf875bddd6dc4dadb13e11d7f"><div class="ttname"><a href="#a58d1d45bf875bddd6dc4dadb13e11d7f">MAX_FILE_SYSTEM_ADRESS_SIZE</a></div><div class="ttdeci">#define MAX_FILE_SYSTEM_ADRESS_SIZE</div><div class="ttdoc">Maximum length (in characters) of a file system path or address.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00021">код/kursa/antivirus.c:21</a></div></div>
<div class="ttc" id="aa00061_html_a8e3328c6c60e31ff127ca888d472fb0c"><div class="ttname"><a href="#a8e3328c6c60e31ff127ca888d472fb0c">read_signature</a></div><div class="ttdeci">int read_signature(const char *file_path, VirusSignature *vs)</div><div class="ttdoc">Reads a virus signature from a file.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00575">код/kursa/antivirus.c:575</a></div></div>
<div class="ttc" id="aa00061_html_aa89d5cbcf8384ad01bd00a74da7d7d5f"><div class="ttname"><a href="#aa89d5cbcf8384ad01bd00a74da7d7d5f">scan_file</a></div><div class="ttdeci">int scan_file(const char *file_path, VirusSignature *vs)</div><div class="ttdoc">Scans a file for a known virus signature.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00734">код/kursa/antivirus.c:734</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/de8/a00061_source.html#l00242">MAIN_OK_PRINTF_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00233">MAIN_RS_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00230">MAIN_RS_PRINTF_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00251">MAIN_SF_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00248">MAIN_SF_PRINTF_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00224">MAIN_SIGN_PRINTF_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00227">MAIN_SIGN_SCANF_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00221">MAIN_SUCCESS</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00236">MAIN_TARG_PRINTF_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00239">MAIN_TARG_SCANF_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00245">MAIN_VIRUS_PRINTF_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00021">MAX_FILE_SYSTEM_ADRESS_SIZE</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00575">read_signature()</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00092">RS_FILE_FCLOSE_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00080">RS_FILE_FOPEN_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00074">RS_NULL_FILE_PATH_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00077">RS_NULL_VSTRUCT_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00086">RS_OFFSET_FSCANF_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00083">RS_SIGNATURE_FSCANF_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00071">RS_SUCCESS</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00089">RS_VNAME_FSCANF_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00734">scan_file()</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00193">SF_BUFFER_FREAD_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00178">SF_CFS_END_FSEEK_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00184">SF_CFS_FILE_FCLOSE_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00175">SF_CFS_FILE_FOPEN_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00172">SF_CFS_NULL_FILE_SIZE_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00169">SF_CFS_NULL_PATH_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00181">SF_CFS_SIZE_FTELL_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00196">SF_FILE_FCLOSE_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00160">SF_FILE_FOPEN_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00163">SF_MZ_FREAD_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00166">SF_NOT_PE</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00154">SF_NULL_FILE_PATH_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00157">SF_NULL_VSTRUCT_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00190">SF_OFFSET_FSEEK_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00187">SF_SMALL_FILE_SIZE</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00151">SF_SUCCESS</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00199">SF_VIRUS_DETECTED</a>, and <a class="el" href="../../d4/de8/a00061_source.html#l00034">VirusSignature::virus_name</a>.</p>

</div>
</div>
<a id="a8e3328c6c60e31ff127ca888d472fb0c" name="a8e3328c6c60e31ff127ca888d472fb0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e3328c6c60e31ff127ca888d472fb0c">&#9670;&#160;</a></span>read_signature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_signature </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>file_path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d46/a00002.html#d0/dc0/a00033">VirusSignature</a> *</td>          <td class="paramname"><span class="paramname"><em>vs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads a virus signature from a file. </p>
<p>This function loads the virus signature, offset, and name from a text file into a <a class="el" href="../../d7/d46/a00002.html#d0/dc0/a00033" title="Represents a virus signature.">VirusSignature</a> structure.</p>
<p>File format should be: </p><div class="fragment"><div class="line">4D 5A 90 00 03 00 00 00 1234 ExampleVirus</div>
</div><!-- fragment --><p>Example usage: </p><div class="fragment"><div class="line"><a class="code hl_struct" href="../../d7/d46/a00002.html#d0/dc0/a00033">VirusSignature</a> vs;</div>
<div class="line"><span class="keywordtype">int</span> result = <a class="code hl_function" href="#a8e3328c6c60e31ff127ca888d472fb0c">read_signature</a>(<span class="stringliteral">&quot;signature.txt&quot;</span>, &amp;vs);</div>
<div class="line"><span class="keywordflow">if</span> (result == <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487cadb1dd6134c0f933bc9659935942d908f">RS_SUCCESS</a>)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;Signature loaded: %s\n&quot;</span>, vs.<a class="code hl_variable" href="../../d7/d46/a00002.html#abafda29c1fbbe5c07c36dcecb5d1a4d6">virus_name</a>);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error code: %d\n&quot;</span>, result);</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file_path</td><td>Path to the file containing the signature. </td></tr>
    <tr><td class="paramname">vs</td><td>Pointer to the <a class="el" href="../../d7/d46/a00002.html#d0/dc0/a00033" title="Represents a virus signature.">VirusSignature</a> structure to be filled. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code from <a class="el" href="#a55394e67b4669c9f3d522ff7d354487c">Error_Codes_RS</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/de8/a00061_source.html#l00575">575</a> of file <a class="el" href="../../d4/de8/a00061_source.html">код/kursa/antivirus.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  576</span>{</div>
<div class="line"><span class="lineno">  577</span>    <span class="keywordflow">if</span> (file_path == NULL)</div>
<div class="line"><span class="lineno">  578</span>    {</div>
<div class="line"><span class="lineno">  579</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487cad5c1ee2dcd3eced7b598f0f7eddde9ce">RS_NULL_FILE_PATH_POINTER</a>; <span class="comment">// 1</span></div>
<div class="line"><span class="lineno">  580</span>    }</div>
<div class="line"><span class="lineno">  581</span>    <span class="keywordflow">if</span> (vs == NULL)</div>
<div class="line"><span class="lineno">  582</span>    {</div>
<div class="line"><span class="lineno">  583</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487ca22802c47292e70b0a339ff994b7907c9">RS_NULL_VSTRUCT_POINTER</a>; <span class="comment">// 2</span></div>
<div class="line"><span class="lineno">  584</span>    }</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>    <span class="comment">// Declare all the variables:</span></div>
<div class="line"><span class="lineno">  587</span>    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><span class="lineno">  588</span>    FILE *file = fopen(file_path, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>    <span class="keywordflow">if</span> (file == NULL)</div>
<div class="line"><span class="lineno">  591</span>    {</div>
<div class="line"><span class="lineno">  592</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487ca72f057ce83550944e650aaac64734965">RS_FILE_FOPEN_ERROR</a>; <span class="comment">// 3</span></div>
<div class="line"><span class="lineno">  593</span>    }</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>    <span class="keywordflow">for</span> (i = 0; i &lt; <span class="keyword">sizeof</span>(vs-&gt;<a class="code hl_variable" href="../../d7/d46/a00002.html#a5dd08f3395ee705f333a09ba0ac63778">signature</a>) / <span class="keyword">sizeof</span>(vs-&gt;<a class="code hl_variable" href="../../d7/d46/a00002.html#a5dd08f3395ee705f333a09ba0ac63778">signature</a>[0]); i++)</div>
<div class="line"><span class="lineno">  596</span>    {</div>
<div class="line"><span class="lineno">  597</span>        <span class="keywordflow">if</span> (fscanf(file, <span class="stringliteral">&quot;%hhx&quot;</span>, &amp;vs-&gt;<a class="code hl_variable" href="../../d7/d46/a00002.html#a5dd08f3395ee705f333a09ba0ac63778">signature</a>[i]) != 1)</div>
<div class="line"><span class="lineno">  598</span>        {</div>
<div class="line"><span class="lineno">  599</span>            fclose(file);</div>
<div class="line"><span class="lineno">  600</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487ca4e716b355dce153ee5b2ff3fd2bfccd1">RS_SIGNATURE_FSCANF_ERROR</a>; <span class="comment">// 4</span></div>
<div class="line"><span class="lineno">  601</span>        }</div>
<div class="line"><span class="lineno">  602</span>    }</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>    <span class="keywordflow">if</span> (fscanf(file, <span class="stringliteral">&quot;%zx&quot;</span>, &amp;vs-&gt;<a class="code hl_variable" href="../../d7/d46/a00002.html#a74f88d067cee336d3b43235eb3f074e8">offset</a>) != 1)</div>
<div class="line"><span class="lineno">  605</span>    {</div>
<div class="line"><span class="lineno">  606</span>        fclose(file);</div>
<div class="line"><span class="lineno">  607</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487cae61710028a61c4d375b610bf6d821469">RS_OFFSET_FSCANF_ERROR</a>; <span class="comment">// 5</span></div>
<div class="line"><span class="lineno">  608</span>    }</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>    <span class="keywordflow">if</span> (fscanf(file, <span class="stringliteral">&quot;%s&quot;</span>, vs-&gt;<a class="code hl_variable" href="../../d7/d46/a00002.html#abafda29c1fbbe5c07c36dcecb5d1a4d6">virus_name</a>) != 1)</div>
<div class="line"><span class="lineno">  611</span>    {</div>
<div class="line"><span class="lineno">  612</span>        fclose(file);</div>
<div class="line"><span class="lineno">  613</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487ca5bab52062e9e8a25d41337700a267d51">RS_VNAME_FSCANF_ERROR</a>; <span class="comment">// 6</span></div>
<div class="line"><span class="lineno">  614</span>    }</div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>    <span class="keywordflow">if</span> (fclose(file) != 0)</div>
<div class="line"><span class="lineno">  617</span>    {</div>
<div class="line"><span class="lineno">  618</span>        fclose(file);</div>
<div class="line"><span class="lineno">  619</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487ca0cda8a27dadca17b568a928144060c83">RS_FILE_FCLOSE_ERROR</a>; <span class="comment">// 7</span></div>
<div class="line"><span class="lineno">  620</span>    }</div>
<div class="line"><span class="lineno">  621</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487cadb1dd6134c0f933bc9659935942d908f">RS_SUCCESS</a>; <span class="comment">// 0</span></div>
<div class="line"><span class="lineno">  622</span>}</div>
<div class="ttc" id="aa00002_html_a5dd08f3395ee705f333a09ba0ac63778"><div class="ttname"><a href="../../d7/d46/a00002.html#a5dd08f3395ee705f333a09ba0ac63778">VirusSignature::signature</a></div><div class="ttdeci">unsigned char signature[8]</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00032">код/kursa/antivirus.c:32</a></div></div>
<div class="ttc" id="aa00002_html_a74f88d067cee336d3b43235eb3f074e8"><div class="ttname"><a href="../../d7/d46/a00002.html#a74f88d067cee336d3b43235eb3f074e8">VirusSignature::offset</a></div><div class="ttdeci">size_t offset</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00033">код/kursa/antivirus.c:33</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/de8/a00061_source.html#l00033">VirusSignature::offset</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00092">RS_FILE_FCLOSE_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00080">RS_FILE_FOPEN_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00074">RS_NULL_FILE_PATH_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00077">RS_NULL_VSTRUCT_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00086">RS_OFFSET_FSCANF_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00083">RS_SIGNATURE_FSCANF_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00071">RS_SUCCESS</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00089">RS_VNAME_FSCANF_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00032">VirusSignature::signature</a>, and <a class="el" href="../../d4/de8/a00061_source.html#l00034">VirusSignature::virus_name</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/de8/a00061_source.html#l00269">main()</a>.</p>

</div>
</div>
<a id="aa89d5cbcf8384ad01bd00a74da7d7d5f" name="aa89d5cbcf8384ad01bd00a74da7d7d5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa89d5cbcf8384ad01bd00a74da7d7d5f">&#9670;&#160;</a></span>scan_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int scan_file </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>file_path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d46/a00002.html#d0/dc0/a00033">VirusSignature</a> *</td>          <td class="paramname"><span class="paramname"><em>vs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scans a file for a known virus signature. </p>
<p>This function checks whether the given file is a PE (Portable Executable) file, verifies that the file is large enough to contain the virus signature at the specified offset, and compares the contents of the file at that offset to the known virus signature.</p>
<p>Example usage: </p><div class="fragment"><div class="line"><a class="code hl_struct" href="../../d7/d46/a00002.html#d0/dc0/a00033">VirusSignature</a> vs;</div>
<div class="line"><span class="keywordtype">int</span> rs_result, sf_result;</div>
<div class="line"> </div>
<div class="line">rs_result = <a class="code hl_function" href="#a8e3328c6c60e31ff127ca888d472fb0c">read_signature</a>(<span class="stringliteral">&quot;signature.txt&quot;</span>, &amp;vs);</div>
<div class="line"><span class="keywordflow">if</span> (rs_result != <a class="code hl_enumvalue" href="#a55394e67b4669c9f3d522ff7d354487cadb1dd6134c0f933bc9659935942d908f">RS_SUCCESS</a>)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;Error reading signature: %d\n&quot;</span>, rs_result);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> sf_result = <a class="code hl_function" href="#aa89d5cbcf8384ad01bd00a74da7d7d5f">scan_file</a>(<span class="stringliteral">&quot;target.exe&quot;</span>, &amp;vs);</div>
<div class="line"><span class="keywordflow">switch</span> (sf_result)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4ae8c7a0c90e729ec8abeb076a020a549e">SF_SUCCESS</a>:</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;The file is clean.\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4ac5ea9da038bf21167935fe4dd4004853">SF_VIRUS_DETECTED</a>:</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Virus detected!\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error during scan: %d\n&quot;</span>, sf_result);</div>
<div class="line">    }</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file_path</td><td>Path to the file to scan. </td></tr>
    <tr><td class="paramname">vs</td><td>Pointer to a <a class="el" href="../../d7/d46/a00002.html#d0/dc0/a00033" title="Represents a virus signature.">VirusSignature</a> structure containing the known signature. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code from <a class="el" href="#a71294fb18b2f091cb4db120c47248cb4">Error_Codes_SF</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/de8/a00061_source.html#l00734">734</a> of file <a class="el" href="../../d4/de8/a00061_source.html">код/kursa/antivirus.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  735</span>{</div>
<div class="line"><span class="lineno">  736</span>    <span class="keywordflow">if</span> (file_path == NULL)</div>
<div class="line"><span class="lineno">  737</span>    {</div>
<div class="line"><span class="lineno">  738</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a83e9a4b31aea3d4bab1534d67bd8fac1">SF_NULL_FILE_PATH_POINTER</a>; <span class="comment">// 1</span></div>
<div class="line"><span class="lineno">  739</span>    }</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>    <span class="keywordflow">if</span> (vs == NULL)</div>
<div class="line"><span class="lineno">  742</span>    {</div>
<div class="line"><span class="lineno">  743</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a83af1a50193d6dbcda3c5c1d9bdb554d">SF_NULL_VSTRUCT_POINTER</a>; <span class="comment">// 2</span></div>
<div class="line"><span class="lineno">  744</span>    }</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>    <span class="comment">// Declare all the variables:</span></div>
<div class="line"><span class="lineno">  747</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buffer[<a class="code hl_define" href="#a1f9805263a7a02041237a4a990811e57">MAX_SIGNATURE_LENGTH</a>];</div>
<div class="line"><span class="lineno">  748</span>    <span class="keywordtype">size_t</span> element_size, elements_number, file_size;</div>
<div class="line"><span class="lineno">  749</span>    <span class="keywordtype">int</span> result, MZ_flag = 0, flag = 0; <span class="comment">// MZ_flag for MZ check, flag for memcmp check</span></div>
<div class="line"><span class="lineno">  750</span>    FILE *file;</div>
<div class="line"><span class="lineno">  751</span>    uint16_t MZ1 = 0, MZ2 = 0;</div>
<div class="line"><span class="lineno">  752</span> </div>
<div class="line"><span class="lineno">  753</span>    file = fopen(file_path, <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><span class="lineno">  754</span>    <span class="keywordflow">if</span> (file == NULL)</div>
<div class="line"><span class="lineno">  755</span>    {</div>
<div class="line"><span class="lineno">  756</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a5f412aaaa3f73e6ab637f802ee3c70dc">SF_FILE_FOPEN_ERROR</a>; <span class="comment">// 3</span></div>
<div class="line"><span class="lineno">  757</span>    }</div>
<div class="line"><span class="lineno">  758</span>    <span class="comment">// snachala proverka na MZ -&gt; zatem na file_size -&gt; zatem na signaturu</span></div>
<div class="line"><span class="lineno">  759</span>    <span class="keywordflow">if</span> (fread(&amp;MZ1, <span class="keyword">sizeof</span>(uint16_t), 1, file) != 1)</div>
<div class="line"><span class="lineno">  760</span>    {</div>
<div class="line"><span class="lineno">  761</span>        fclose(file);</div>
<div class="line"><span class="lineno">  762</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4aaf13c1451cb5a1d26f4eb5bac5331bd6">SF_MZ_FREAD_ERROR</a>; <span class="comment">// 4</span></div>
<div class="line"><span class="lineno">  763</span>    }</div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>    MZ2 = ((<span class="charliteral">&#39;Z&#39;</span> &lt;&lt; 8) | <span class="charliteral">&#39;M&#39;</span>); <span class="comment">// MZ bytes in hexadecimal format</span></div>
<div class="line"><span class="lineno">  766</span>    <span class="keywordflow">if</span> (MZ1 == MZ2)</div>
<div class="line"><span class="lineno">  767</span>    {</div>
<div class="line"><span class="lineno">  768</span>        MZ_flag = 1;</div>
<div class="line"><span class="lineno">  769</span>    }</div>
<div class="line"><span class="lineno">  770</span>    <span class="comment">/* uncomment to debug</span></div>
<div class="line"><span class="lineno">  771</span><span class="comment">    printf(&quot;%04X\n&quot;,MZ1);</span></div>
<div class="line"><span class="lineno">  772</span><span class="comment">    printf(&quot;%04X\n&quot;,MZ2);</span></div>
<div class="line"><span class="lineno">  773</span><span class="comment">    printf(&quot;%d\n&quot;,MZ_flag);</span></div>
<div class="line"><span class="lineno">  774</span><span class="comment">    */</span></div>
<div class="line"><span class="lineno">  775</span>    <span class="keywordflow">if</span> (MZ_flag == 0)</div>
<div class="line"><span class="lineno">  776</span>    {</div>
<div class="line"><span class="lineno">  777</span>        fclose(file);</div>
<div class="line"><span class="lineno">  778</span>        <span class="comment">//printf(&quot;NOT_PE&quot;);</span></div>
<div class="line"><span class="lineno">  779</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a3517b65ae973d0d3c3e9f2dabffe3923">SF_NOT_PE</a>; <span class="comment">// 5</span></div>
<div class="line"><span class="lineno">  780</span>    }</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span>    result = <a class="code hl_function" href="#ac151026d2ff41253cf6e6c247eab91b1">calculate_file_size</a>(file_path, &amp;file_size);</div>
<div class="line"><span class="lineno">  783</span>    <span class="keywordflow">if</span> (result != <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1ad622e94493a882562592bbe767353b71">CFS_SUCCESS</a>) <span class="comment">// case 0</span></div>
<div class="line"><span class="lineno">  784</span>    {</div>
<div class="line"><span class="lineno">  785</span>        <span class="keywordflow">switch</span> (result)</div>
<div class="line"><span class="lineno">  786</span>        {</div>
<div class="line"><span class="lineno">  787</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1a6d718b6f23a18eaefa43664ee3dc763d">CFS_NULL_FILE_PATH_POINTER</a>: <span class="comment">// case 1</span></div>
<div class="line"><span class="lineno">  788</span>            {</div>
<div class="line"><span class="lineno">  789</span>                fclose(file);</div>
<div class="line"><span class="lineno">  790</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4add83add67dcd7ba7c6c8398b2259bc6c">SF_CFS_NULL_PATH_POINTER</a>; <span class="comment">// 6</span></div>
<div class="line"><span class="lineno">  791</span>            }</div>
<div class="line"><span class="lineno">  792</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1a8b09752e65b1530123e2460d6536492d">CFS_NULL_FILE_SIZE_POINTER</a>: <span class="comment">// case 2</span></div>
<div class="line"><span class="lineno">  793</span>            {</div>
<div class="line"><span class="lineno">  794</span>                fclose(file);</div>
<div class="line"><span class="lineno">  795</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a2a9d23d17b854dd73a2d3a78ac46fbb0">SF_CFS_NULL_FILE_SIZE_POINTER</a>; <span class="comment">// 7</span></div>
<div class="line"><span class="lineno">  796</span>            }</div>
<div class="line"><span class="lineno">  797</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1a1f73fee4befb453fa5534f53c04a6d5b">CFS_FILE_FOPEN_ERROR</a>: <span class="comment">// case 3</span></div>
<div class="line"><span class="lineno">  798</span>            {</div>
<div class="line"><span class="lineno">  799</span>                fclose(file);</div>
<div class="line"><span class="lineno">  800</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a27175d186bd0cc8ef253f55c3c5a6e22">SF_CFS_FILE_FOPEN_ERROR</a>; <span class="comment">// 8</span></div>
<div class="line"><span class="lineno">  801</span>            }</div>
<div class="line"><span class="lineno">  802</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1ad5c83b632548a90f3febe7168cc29e7d">CFS_END_FSEEK_ERROR</a>: <span class="comment">// case 4</span></div>
<div class="line"><span class="lineno">  803</span>            {</div>
<div class="line"><span class="lineno">  804</span>                fclose(file);</div>
<div class="line"><span class="lineno">  805</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a9b337b7034141e114453e51d431de3cd">SF_CFS_END_FSEEK_ERROR</a>; <span class="comment">// 9</span></div>
<div class="line"><span class="lineno">  806</span>            }</div>
<div class="line"><span class="lineno">  807</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1aab1185a29decc2242b01e17afb12e435">CFS_SIZE_FTELL_ERROR</a>: <span class="comment">// case 5</span></div>
<div class="line"><span class="lineno">  808</span>            {</div>
<div class="line"><span class="lineno">  809</span>                fclose(file);</div>
<div class="line"><span class="lineno">  810</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a8be7baf87fa305815af016e51a32e444">SF_CFS_SIZE_FTELL_ERROR</a>; <span class="comment">// 10</span></div>
<div class="line"><span class="lineno">  811</span>            }</div>
<div class="line"><span class="lineno">  812</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="#a6d150856ebcbc39802d95e25f1330df1aafb51e061b61c1f662dc5c3dddf19366">CFS_FILE_FCLOSE_ERROR</a>: <span class="comment">// case 6</span></div>
<div class="line"><span class="lineno">  813</span>            {</div>
<div class="line"><span class="lineno">  814</span>                fclose(file);</div>
<div class="line"><span class="lineno">  815</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4af3946e9f0e9ce7b8afc78d5e15b21bc0">SF_CFS_FILE_FCLOSE_ERROR</a>; <span class="comment">// 11</span></div>
<div class="line"><span class="lineno">  816</span>            }</div>
<div class="line"><span class="lineno">  817</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  818</span>            {</div>
<div class="line"><span class="lineno">  819</span>                <span class="comment">//nothing, maybe rewrite in the future...</span></div>
<div class="line"><span class="lineno">  820</span>                fclose(file);</div>
<div class="line"><span class="lineno">  821</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  822</span>            }</div>
<div class="line"><span class="lineno">  823</span>        }</div>
<div class="line"><span class="lineno">  824</span>    }</div>
<div class="line"><span class="lineno">  825</span>    <span class="comment">// Proverka razmerov filov; uncomment to check file sizes</span></div>
<div class="line"><span class="lineno">  826</span>    <span class="comment">// printf(&quot;%zu\n\n&quot;, vs-&gt;offset + (sizeof(vs-&gt;signature) / sizeof(vs-&gt;signature[0])));</span></div>
<div class="line"><span class="lineno">  827</span>    <span class="comment">// printf(&quot;%zu&quot;, file_size);</span></div>
<div class="line"><span class="lineno">  828</span> </div>
<div class="line"><span class="lineno">  829</span>    <span class="comment">// offset + (length of signatire) &gt; file_size -&gt; file is safe</span></div>
<div class="line"><span class="lineno">  830</span>    <span class="keywordflow">if</span> (vs-&gt;<a class="code hl_variable" href="../../d7/d46/a00002.html#a74f88d067cee336d3b43235eb3f074e8">offset</a> + (<span class="keyword">sizeof</span>(vs-&gt;<a class="code hl_variable" href="../../d7/d46/a00002.html#a5dd08f3395ee705f333a09ba0ac63778">signature</a>) / <span class="keyword">sizeof</span>(vs-&gt;<a class="code hl_variable" href="../../d7/d46/a00002.html#a5dd08f3395ee705f333a09ba0ac63778">signature</a>[0])) &gt; file_size)</div>
<div class="line"><span class="lineno">  831</span>    {</div>
<div class="line"><span class="lineno">  832</span>        fclose(file);</div>
<div class="line"><span class="lineno">  833</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a77690c5eb7fc8973edd3f2a3a048d9ad">SF_SMALL_FILE_SIZE</a>; <span class="comment">// 12</span></div>
<div class="line"><span class="lineno">  834</span>    }</div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>    <span class="keywordflow">if</span> (fseek(file, vs-&gt;<a class="code hl_variable" href="../../d7/d46/a00002.html#a74f88d067cee336d3b43235eb3f074e8">offset</a>, SEEK_SET) != 0)</div>
<div class="line"><span class="lineno">  837</span>    {</div>
<div class="line"><span class="lineno">  838</span>        fclose(file);</div>
<div class="line"><span class="lineno">  839</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a9652d75e01f85a8c943d1306e9ff2482">SF_OFFSET_FSEEK_ERROR</a>; <span class="comment">// 13</span></div>
<div class="line"><span class="lineno">  840</span>    }</div>
<div class="line"><span class="lineno">  841</span> </div>
<div class="line"><span class="lineno">  842</span>    element_size = <span class="keyword">sizeof</span>(buffer[0]);</div>
<div class="line"><span class="lineno">  843</span>    elements_number = <span class="keyword">sizeof</span>(buffer)/<span class="keyword">sizeof</span>(buffer[0]);</div>
<div class="line"><span class="lineno">  844</span> </div>
<div class="line"><span class="lineno">  845</span>    <span class="keywordflow">if</span> (fread(buffer, element_size, elements_number, file) != elements_number)</div>
<div class="line"><span class="lineno">  846</span>    {</div>
<div class="line"><span class="lineno">  847</span>        fclose(file);</div>
<div class="line"><span class="lineno">  848</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4af45f699f07fb92dd03463c708b9286ea">SF_BUFFER_FREAD_ERROR</a>; <span class="comment">// 14</span></div>
<div class="line"><span class="lineno">  849</span>    }</div>
<div class="line"><span class="lineno">  850</span>    <span class="comment">// if equal -&gt; memcmp should be 0 -&gt; virus in file -&gt; file is not safe</span></div>
<div class="line"><span class="lineno">  851</span>    <span class="keywordflow">if</span> (memcmp(buffer, vs-&gt;<a class="code hl_variable" href="../../d7/d46/a00002.html#a5dd08f3395ee705f333a09ba0ac63778">signature</a>, elements_number) == 0)</div>
<div class="line"><span class="lineno">  852</span>    {</div>
<div class="line"><span class="lineno">  853</span>        flag = 1; <span class="comment">// virus in file</span></div>
<div class="line"><span class="lineno">  854</span>    }</div>
<div class="line"><span class="lineno">  855</span>    <span class="comment">//else flag = 0; This could be either an error in the memcmp function itself or the fact that there is no virus present</span></div>
<div class="line"><span class="lineno">  856</span>    <span class="keywordflow">if</span> (fclose(file) != 0)</div>
<div class="line"><span class="lineno">  857</span>    {</div>
<div class="line"><span class="lineno">  858</span>        fclose(file);</div>
<div class="line"><span class="lineno">  859</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4a2a4b00c4f9b7804235df9c4a6218a547">SF_FILE_FCLOSE_ERROR</a>; <span class="comment">// 15</span></div>
<div class="line"><span class="lineno">  860</span>    }</div>
<div class="line"><span class="lineno">  861</span>    <span class="comment">// if flag = 1 -&gt; virus in file; else if flag = 0 -&gt; virus not in file -&gt; SF_SUCCESS</span></div>
<div class="line"><span class="lineno">  862</span>    <span class="keywordflow">if</span> (flag == 1)</div>
<div class="line"><span class="lineno">  863</span>    {</div>
<div class="line"><span class="lineno">  864</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4ac5ea9da038bf21167935fe4dd4004853">SF_VIRUS_DETECTED</a>; <span class="comment">// 16</span></div>
<div class="line"><span class="lineno">  865</span>    }</div>
<div class="line"><span class="lineno">  866</span> </div>
<div class="line"><span class="lineno">  867</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="#a71294fb18b2f091cb4db120c47248cb4ae8c7a0c90e729ec8abeb076a020a549e">SF_SUCCESS</a>; <span class="comment">// 0</span></div>
<div class="line"><span class="lineno">  868</span>}</div>
<div class="ttc" id="aa00061_html_a1f9805263a7a02041237a4a990811e57"><div class="ttname"><a href="#a1f9805263a7a02041237a4a990811e57">MAX_SIGNATURE_LENGTH</a></div><div class="ttdeci">#define MAX_SIGNATURE_LENGTH</div><div class="ttdoc">Maximum length (in bytes) of a virus signature.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/de8/a00061_source.html#l00011">код/kursa/antivirus.c:11</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/de8/a00061_source.html#l00648">calculate_file_size()</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00124">CFS_END_FSEEK_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00130">CFS_FILE_FCLOSE_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00121">CFS_FILE_FOPEN_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00115">CFS_NULL_FILE_PATH_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00118">CFS_NULL_FILE_SIZE_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00127">CFS_SIZE_FTELL_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00112">CFS_SUCCESS</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00011">MAX_SIGNATURE_LENGTH</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00033">VirusSignature::offset</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00193">SF_BUFFER_FREAD_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00178">SF_CFS_END_FSEEK_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00184">SF_CFS_FILE_FCLOSE_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00175">SF_CFS_FILE_FOPEN_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00172">SF_CFS_NULL_FILE_SIZE_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00169">SF_CFS_NULL_PATH_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00181">SF_CFS_SIZE_FTELL_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00196">SF_FILE_FCLOSE_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00160">SF_FILE_FOPEN_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00163">SF_MZ_FREAD_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00166">SF_NOT_PE</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00154">SF_NULL_FILE_PATH_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00157">SF_NULL_VSTRUCT_POINTER</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00190">SF_OFFSET_FSEEK_ERROR</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00187">SF_SMALL_FILE_SIZE</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00151">SF_SUCCESS</a>, <a class="el" href="../../d4/de8/a00061_source.html#l00199">SF_VIRUS_DETECTED</a>, and <a class="el" href="../../d4/de8/a00061_source.html#l00032">VirusSignature::signature</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/de8/a00061_source.html#l00269">main()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_9e38fe205de5d289597ee2838d06473b.html">код</a></li><li class="navelem"><a class="el" href="../../dir_b81dde1d45653db1957266086b662f2c.html">kursa</a></li><li class="navelem"><a class="el" href="../../d4/de8/a00061.html">antivirus.c</a></li>
    <li class="footer">Generated on Sat May 10 2025 17:53:16 for Antivirus by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
